(function webpackUniversalModuleDefinition(root, factory) {
  if (typeof exports === 'object' && typeof module === 'object')
    module.exports = factory();
  else if (typeof define === 'function' && define.amd) define([], factory);
        else if (typeof exports === 'object') exports['deck'] = factory();
  else root['deck'] = factory();})(globalThis, function () {
"use strict";var __exports__=(()=>{var jo=Object.create;var nt=Object.defineProperty;var Vo=Object.getOwnPropertyDescriptor;var ko=Object.getOwnPropertyNames;var Qo=Object.getPrototypeOf,Yo=Object.prototype.hasOwnProperty;var Ut=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),w=(t,e)=>{for(var n in e)nt(t,n,{get:e[n],enumerable:!0})},tt=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ko(e))!Yo.call(t,s)&&s!==n&&nt(t,s,{get:()=>e[s],enumerable:!(r=Vo(e,s))||r.enumerable});return t},te=(t,e,n)=>(tt(t,e,"default"),n&&tt(n,e,"default")),G=(t,e,n)=>(n=t!=null?jo(Qo(t)):{},tt(e||!t||!t.__esModule?nt(n,"default",{value:t,enumerable:!0}):n,t)),Wo=t=>tt(nt({},"__esModule",{value:!0}),t);var me=Ut((qf,er)=>{er.exports=globalThis.deck});var Fe=Ut(($f,nr)=>{nr.exports=globalThis.luma});var De=Ut((el,rr)=>{rr.exports=globalThis.luma});var et={};w(et,{ScenegraphLayer:()=>$e,SimpleMeshLayer:()=>Le});var j={},tr=G(me(),1);te(j,G(me(),1));if(!tr.Layer)throw new Error("@deck.gl/core is not found");te(et,j);var V=G(me(),1),mr=G(Fe(),1),he=G(De(),1);var ue=G(me(),1),Nt=Math.PI/180,rt=new Float32Array(16),sr=new Float32Array(12);function or(t,e,n){let r=e[0]*Nt,s=e[1]*Nt,o=e[2]*Nt,i=Math.sin(o),a=Math.sin(r),c=Math.sin(s),f=Math.cos(o),l=Math.cos(r),A=Math.cos(s),m=n[0],u=n[1],h=n[2];t[0]=m*A*l,t[1]=m*c*l,t[2]=m*-a,t[3]=u*(-c*f+A*a*i),t[4]=u*(A*f+c*a*i),t[5]=u*l*i,t[6]=h*(c*i+A*a*f),t[7]=h*(-A*i+c*a*f),t[8]=h*l*f}function ir(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}var st={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrixCol0:{size:3,elementOffset:0},instanceModelMatrixCol1:{size:3,elementOffset:3},instanceModelMatrixCol2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){let{data:r,getOrientation:s,getScale:o,getTranslation:i,getTransformMatrix:a}=this.props,c=Array.isArray(a),f=c&&a.length===16,l=Array.isArray(o),A=Array.isArray(s),m=Array.isArray(i),u=f||!c&&Boolean(a(r[0]));u?t.constant=f:t.constant=A&&l&&m;let h=t.value;if(t.constant){let d;u?(rt.set(a),d=ir(rt)):(d=sr,or(d,s,o),d.set(i,9)),t.value=new Float32Array(d)}else{let d=e*t.size,{iterable:p,objectInfo:g}=(0,ue.createIterable)(r,e,n);for(let E of p){g.index++;let B;if(u)rt.set(f?a:a(E,g)),B=ir(rt);else{B=sr;let x=A?s:s(E,g),C=l?o:o(E,g);or(B,x,C),B.set(m?i:i(E,g),9)}h[d++]=B[0],h[d++]=B[1],h[d++]=B[2],h[d++]=B[3],h[d++]=B[4],h[d++]=B[5],h[d++]=B[6],h[d++]=B[7],h[d++]=B[8],h[d++]=B[9],h[d++]=B[10],h[d++]=B[11]}}}};function ot(t,e){return e===ue.COORDINATE_SYSTEM.CARTESIAN||e===ue.COORDINATE_SYSTEM.METER_OFFSETS||e===ue.COORDINATE_SYSTEM.DEFAULT&&!t.isGeospatial}var ar=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = texCoords;
geometry.pickingColor = instancePickingColors;
vTexCoord = texCoords;
cameraPosition = project_uCameraPosition;
vColor = vec4(colors * instanceColors.rgb, instanceColors.a);
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;
if (composeModelMatrix) {
DECKGL_FILTER_SIZE(pos, geometry);
normals_commonspace = project_normal(instanceModelMatrix * normals);
geometry.worldPosition += pos;
gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
geometry.position = position_commonspace;
}
else {
pos = project_size(pos);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
geometry.position = position_commonspace;
normals_commonspace = project_normal(instanceModelMatrix * normals);
}
geometry.normal = normals_commonspace;
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var cr=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs
precision highp float;
uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;
in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
geometry.uv = vTexCoord;
vec3 normal;
if (flatShading) {
normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
} else {
normal = normals_commonspace;
}
vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
DECKGL_FILTER_COLOR(color, geometry);
vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
fragColor = vec4(lightColor, color.a * opacity);
}
`;function fr(t){switch(t.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}function Oe(t){let e=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,i=-1/0,a=t.POSITION?t.POSITION.value:[],c=a&&a.length;for(let f=0;f<c;f+=3){let l=a[f],A=a[f+1],m=a[f+2];e=l<e?l:e,n=A<n?A:n,r=m<r?m:r,s=l>s?l:s,o=A>o?A:o,i=m>i?m:i}return[[e,n,r],[s,o,i]]}function Ht(t,e,n){let r=fr(e.value),s=n||lr(e);return{name:t,type:{type:"fixed-size-list",listSize:e.size,children:[{name:"value",type:r}]},nullable:!1,metadata:s}}function lr(t){let e={};return"byteOffset"in t&&(e.byteOffset=t.byteOffset.toString(10)),"byteStride"in t&&(e.byteStride=t.byteStride.toString(10)),"normalized"in t&&(e.normalized=t.normalized.toString()),e}function Jt(t){let e=t.positions||t.POSITION;V.log.assert(e,'no "postions" or "POSITION" attribute in mesh');let n=e.value.length/e.size,r=t.COLOR_0||t.colors;r||(r={size:3,value:new Float32Array(n*3).fill(1)});let s=t.NORMAL||t.normals;s||(s={size:3,value:new Float32Array(n*3).fill(0)});let o=t.TEXCOORD_0||t.texCoords;return o||(o={size:2,value:new Float32Array(n*2).fill(0)}),{positions:e,colors:r,normals:s,texCoords:o}}function Ar(t){return t instanceof he.Geometry?(t.attributes=Jt(t.attributes),t):t.attributes?new he.Geometry({...t,topology:"triangle-list",attributes:Jt(t.attributes)}):new he.Geometry({topology:"triangle-list",attributes:Jt(t)})}var zo=[0,0,0,255],qo={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:zo},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0,value:null}},it=class extends V.Layer{getShaders(){return super.getShaders({vs:ar,fs:cr,modules:[V.project32,V.phongLighting,V.picking]})}getBounds(){if(this.props._instanced)return super.getBounds();let e=this.state.positionBounds;if(e)return e;let{mesh:n}=this.props;if(!n)return null;if(e=n.header?.boundingBox,!e){let{attributes:r}=Ar(n);r.POSITION=r.POSITION||r.positions,e=Oe(r)}return this.state.positionBounds=e,e}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:"float64",fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:"unorm8",transition:!0,size:this.props.colorFormat.length,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:st}),this.setState({emptyTexture:this.context.device.createTexture({data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);let{props:n,oldProps:r,changeFlags:s}=e;if(n.mesh!==r.mesh||s.extensionsChanged){if(this.state.positionBounds=null,this.state.model?.destroy(),n.mesh){this.state.model=this.getModel(n.mesh);let o=n.mesh.attributes||n.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&n.texture instanceof mr.Texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setTopology(this.props.wireframe?"line-strip":"triangle-list")}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){let{model:n}=this.state;if(!n)return;let{viewport:r,renderPass:s}=this.context,{sizeScale:o,coordinateSystem:i,_instanced:a}=this.props;n.setUniforms(e),n.setUniforms({sizeScale:o,composeModelMatrix:!a||ot(r,i),flatShading:!this.state.hasNormals}),n.draw(s)}get isLoaded(){return Boolean(this.state?.model&&super.isLoaded)}getModel(e){let n=new he.Model(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:Ar(e),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:s}=this.state;return n.setBindings({sampler:r||s}),n.setUniforms({hasTexture:Boolean(r)}),n}setTexture(e){let{emptyTexture:n,model:r}=this.state;r&&(r.setBindings({sampler:e||n}),r.setUniforms({hasTexture:Boolean(e)}))}},Le=it;(()=>{it.defaultProps=qo})(),(()=>{it.layerName="SimpleMeshLayer"})();var z=G(me(),1);var gl=1/Math.PI*180,xl=1/180*Math.PI,Zo={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...Zo}};var b=globalThis.mathgl.config;function ur(t,{precision:e=b.precision}={}){return t=$o(t),`${parseFloat(t.toPrecision(e))}`}function ne(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Kt(t,e,n){let r=b.EPSILON;n&&(b.EPSILON=n);try{if(t===e)return!0;if(ne(t)&&ne(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!Kt(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=b.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{b.EPSILON=r}}function $o(t){return Math.round(t/b.EPSILON)*b.EPSILON}var re=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:ne(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(b)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+ur(this[r],e);return`${e.printTypes?this.constructor.name:""}[${n}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Kt(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let s=0;s<this.ELEMENTS;++s){let o=e[s],i=typeof n=="number"?n:n[s];this[s]=o+r*(i-o)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(let n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(let n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(b.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}};function ei(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function _(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function se(t,e,n=""){if(b.debug&&!ei(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function Xt(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}var de=class extends re{get x(){return this[0]}set x(e){this[0]=_(e)}get y(){return this[1]}set y(e){this[1]=_(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){let s=this[r]-e[r];n+=s*s}return _(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return _(n)}normalize(){let e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(let n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(let n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Xt(e>=0&&e<this.ELEMENTS,"index is out of range"),_(this[e])}setComponent(e,n){return Xt(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}};var I=typeof Float32Array<"u"?Float32Array:Array;var Fl=Math.PI/180;function ti(){let t=new I(2);return I!=Float32Array&&(t[0]=0,t[1]=0),t}function pr(t,e,n){let r=e[0],s=e[1];return t[0]=n[0]*r+n[3]*s+n[6],t[1]=n[1]*r+n[4]*s+n[7],t}function Br(t,e,n){let r=e[0],s=e[1];return t[0]=n[0]*r+n[4]*s+n[12],t[1]=n[1]*r+n[5]*s+n[13],t}var Dl=function(){let t=ti();return function(e,n,r,s,o,i){let a,c;for(n||(n=2),r||(r=0),s?c=Math.min(s*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],o(t,t,i),e[a]=t[0],e[a+1]=t[1];return e}}();function gr(t,e,n){let r=e[0],s=e[1],o=n[3]*r+n[7]*s||1;return t[0]=(n[0]*r+n[4]*s)/o,t[1]=(n[1]*r+n[5]*s)/o,t}function at(t,e,n){let r=e[0],s=e[1],o=e[2],i=n[3]*r+n[7]*s+n[11]*o||1;return t[0]=(n[0]*r+n[4]*s+n[8]*o)/i,t[1]=(n[1]*r+n[5]*s+n[9]*o)/i,t[2]=(n[2]*r+n[6]*s+n[10]*o)/i,t}function xr(t,e,n){let r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t}function Cr(t,e,n){let r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t[3]=e[3],t}function ct(t,e,n){let r=e[0],s=e[1],o=e[2];return t[0]=n[0]*r+n[3]*s+n[6]*o,t[1]=n[1]*r+n[4]*s+n[7]*o,t[2]=n[2]*r+n[5]*s+n[8]*o,t[3]=e[3],t}function jt(){let t=new I(3);return I!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ni(t){let e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function Vt(t,e,n){let r=new I(3);return r[0]=t,r[1]=e,r[2]=n,r}function Er(t,e){let n=e[0],r=e[1],s=e[2],o=n*n+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function kt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function pe(t,e,n){let r=e[0],s=e[1],o=e[2],i=n[0],a=n[1],c=n[2];return t[0]=s*c-o*a,t[1]=o*i-r*c,t[2]=r*a-s*i,t}function Be(t,e,n){let r=e[0],s=e[1],o=e[2],i=n[3]*r+n[7]*s+n[11]*o+n[15];return i=i||1,t[0]=(n[0]*r+n[4]*s+n[8]*o+n[12])/i,t[1]=(n[1]*r+n[5]*s+n[9]*o+n[13])/i,t[2]=(n[2]*r+n[6]*s+n[10]*o+n[14])/i,t}function ft(t,e,n){let r=e[0],s=e[1],o=e[2];return t[0]=r*n[0]+s*n[3]+o*n[6],t[1]=r*n[1]+s*n[4]+o*n[7],t[2]=r*n[2]+s*n[5]+o*n[8],t}function lt(t,e,n){let r=n[0],s=n[1],o=n[2],i=n[3],a=e[0],c=e[1],f=e[2],l=s*f-o*c,A=o*a-r*f,m=r*c-s*a,u=s*m-o*A,h=o*l-r*m,d=r*A-s*l,p=i*2;return l*=p,A*=p,m*=p,u*=2,h*=2,d*=2,t[0]=a+l+u,t[1]=c+A+h,t[2]=f+m+d,t}function Mr(t,e,n,r){let s=[],o=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],o[0]=s[0],o[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),o[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function _r(t,e,n,r){let s=[],o=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],o[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),o[1]=s[1],o[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Tr(t,e,n,r){let s=[],o=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],o[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),o[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),o[2]=s[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function yr(t,e){let n=t[0],r=t[1],s=t[2],o=e[0],i=e[1],a=e[2],c=Math.sqrt((n*n+r*r+s*s)*(o*o+i*i+a*a)),f=c&&kt(t,e)/c;return Math.acos(Math.min(Math.max(f,-1),1))}var br=ni;var Gl=function(){let t=jt();return function(e,n,r,s,o,i){let a,c;for(n||(n=3),r||(r=0),s?c=Math.min(s*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,i),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}();var Qt=[0,0,0],At,ae=class extends de{static get ZERO(){return At||(At=new ae(0,0,0),Object.freeze(At)),At}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&ne(e)?this.copy(e):(b.debug&&(_(e),_(n),_(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return b.debug&&(_(e.x),_(e.y),_(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=_(e)}angle(e){return yr(this,e)}cross(e){return pe(this,this,e),this.check()}rotateX({radians:e,origin:n=Qt}){return Mr(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Qt}){return _r(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Qt}){return Tr(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Be(this,this,e),this.check()}transformAsVector(e){return at(this,this,e),this.check()}transformByMatrix3(e){return ft(this,this,e),this.check()}transformByMatrix2(e){return xr(this,this,e),this.check()}transformByQuaternion(e){return lt(this,this,e),this.check()}};var mt,ge=class extends de{static get ZERO(){return mt||(mt=new ge(0,0,0,0),Object.freeze(mt)),mt}constructor(e=0,n=0,r=0,s=0){super(-0,-0,-0,-0),ne(e)&&arguments.length===1?this.copy(e):(b.debug&&(_(e),_(n),_(r),_(s)),this[0]=e,this[1]=n,this[2]=r,this[3]=s)}set(e,n,r,s){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return b.debug&&(_(e.x),_(e.y),_(e.z),_(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=_(e)}get w(){return this[3]}set w(e){this[3]=_(e)}transform(e){return Be(this,this,e),this.check()}transformByMatrix3(e){return ct(this,this,e),this.check()}transformByMatrix2(e){return Cr(this,this,e),this.check()}transformByQuaternion(e){return lt(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}};var xe=class extends re{toString(){let e="[";if(b.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+n]}`}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=` ${this[n]}`}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=_(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){let r=e*this.RANK;for(let s=0;s<this.RANK;++s)n[s]=this[r+s];return n}setColumn(e,n){let r=e*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=n[s];return this}};function Rr(){let t=new I(9);return I!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Ir(t,e){if(t===e){let n=e[1],r=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Sr(t,e){let n=e[0],r=e[1],s=e[2],o=e[3],i=e[4],a=e[5],c=e[6],f=e[7],l=e[8],A=l*i-a*f,m=-l*o+a*c,u=f*o-i*c,h=n*A+r*m+s*u;return h?(h=1/h,t[0]=A*h,t[1]=(-l*r+s*f)*h,t[2]=(a*r-s*i)*h,t[3]=m*h,t[4]=(l*n-s*c)*h,t[5]=(-a*n+s*o)*h,t[6]=u*h,t[7]=(-f*n+r*c)*h,t[8]=(i*n-r*o)*h,t):null}function Fr(t){let e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],i=t[5],a=t[6],c=t[7],f=t[8];return e*(f*o-i*c)+n*(-f*s+i*a)+r*(c*s-o*a)}function Yt(t,e,n){let r=e[0],s=e[1],o=e[2],i=e[3],a=e[4],c=e[5],f=e[6],l=e[7],A=e[8],m=n[0],u=n[1],h=n[2],d=n[3],p=n[4],g=n[5],E=n[6],B=n[7],x=n[8];return t[0]=m*r+u*i+h*f,t[1]=m*s+u*a+h*l,t[2]=m*o+u*c+h*A,t[3]=d*r+p*i+g*f,t[4]=d*s+p*a+g*l,t[5]=d*o+p*c+g*A,t[6]=E*r+B*i+x*f,t[7]=E*s+B*a+x*l,t[8]=E*o+B*c+x*A,t}function Dr(t,e,n){let r=e[0],s=e[1],o=e[2],i=e[3],a=e[4],c=e[5],f=e[6],l=e[7],A=e[8],m=n[0],u=n[1];return t[0]=r,t[1]=s,t[2]=o,t[3]=i,t[4]=a,t[5]=c,t[6]=m*r+u*i+f,t[7]=m*s+u*a+l,t[8]=m*o+u*c+A,t}function Or(t,e,n){let r=e[0],s=e[1],o=e[2],i=e[3],a=e[4],c=e[5],f=e[6],l=e[7],A=e[8],m=Math.sin(n),u=Math.cos(n);return t[0]=u*r+m*i,t[1]=u*s+m*a,t[2]=u*o+m*c,t[3]=u*i-m*r,t[4]=u*a-m*s,t[5]=u*c-m*o,t[6]=f,t[7]=l,t[8]=A,t}function Wt(t,e,n){let r=n[0],s=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Lr(t,e){let n=e[0],r=e[1],s=e[2],o=e[3],i=n+n,a=r+r,c=s+s,f=n*i,l=r*i,A=r*a,m=s*i,u=s*a,h=s*c,d=o*i,p=o*a,g=o*c;return t[0]=1-A-h,t[3]=l-g,t[6]=m+p,t[1]=l+g,t[4]=1-f-h,t[7]=u-d,t[2]=m-p,t[5]=u+d,t[8]=1-f-A,t}var zt;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(zt||(zt={}));var oi=Object.freeze([1,0,0,0,1,0,0,0,1]),Z=class extends xe{static get IDENTITY(){return ai()}static get ZERO(){return ii()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return zt}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(oi)}fromObject(e){return this.check()}fromQuaternion(e){return Lr(this,e),this.check()}set(e,n,r,s,o,i,a,c,f){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=o,this[5]=i,this[6]=a,this[7]=c,this[8]=f,this.check()}setRowMajor(e,n,r,s,o,i,a,c,f){return this[0]=e,this[1]=s,this[2]=a,this[3]=n,this[4]=o,this[5]=c,this[6]=r,this[7]=i,this[8]=f,this.check()}determinant(){return Fr(this)}transpose(){return Ir(this,this),this.check()}invert(){return Sr(this,this),this.check()}multiplyLeft(e){return Yt(this,e,this),this.check()}multiplyRight(e){return Yt(this,this,e),this.check()}rotate(e){return Or(this,this,e),this.check()}scale(e){return Array.isArray(e)?Wt(this,this,e):Wt(this,this,[e,e]),this.check()}translate(e){return Dr(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=pr(n||[-0,-0],e,this);break;case 3:r=ft(n||[-0,-0,-0],e,this);break;case 4:r=ct(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return se(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}},ut,ht=null;function ii(){return ut||(ut=new Z([0,0,0,0,0,0,0,0,0]),Object.freeze(ut)),ut}function ai(){return ht||(ht=new Z,Object.freeze(ht)),ht}function ci(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gr(t,e){if(t===e){let n=e[1],r=e[2],s=e[3],o=e[6],i=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=s,t[13]=i,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function vr(t,e){let n=e[0],r=e[1],s=e[2],o=e[3],i=e[4],a=e[5],c=e[6],f=e[7],l=e[8],A=e[9],m=e[10],u=e[11],h=e[12],d=e[13],p=e[14],g=e[15],E=n*a-r*i,B=n*c-s*i,x=n*f-o*i,C=r*c-s*a,M=r*f-o*a,F=s*f-o*c,D=l*d-A*h,O=l*p-m*h,L=l*g-u*h,H=A*p-m*d,J=A*g-u*d,K=m*g-u*p,y=E*K-B*J+x*H+C*L-M*O+F*D;return y?(y=1/y,t[0]=(a*K-c*J+f*H)*y,t[1]=(s*J-r*K-o*H)*y,t[2]=(d*F-p*M+g*C)*y,t[3]=(m*M-A*F-u*C)*y,t[4]=(c*L-i*K-f*O)*y,t[5]=(n*K-s*L+o*O)*y,t[6]=(p*x-h*F-g*B)*y,t[7]=(l*F-m*x+u*B)*y,t[8]=(i*J-a*L+f*D)*y,t[9]=(r*L-n*J-o*D)*y,t[10]=(h*M-d*x+g*E)*y,t[11]=(A*x-l*M-u*E)*y,t[12]=(a*O-i*H-c*D)*y,t[13]=(n*H-r*O+s*D)*y,t[14]=(d*B-h*C-p*E)*y,t[15]=(l*C-A*B+m*E)*y,t):null}function Pr(t){let e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],i=t[5],a=t[6],c=t[7],f=t[8],l=t[9],A=t[10],m=t[11],u=t[12],h=t[13],d=t[14],p=t[15],g=e*i-n*o,E=e*a-r*o,B=n*a-r*i,x=f*h-l*u,C=f*d-A*u,M=l*d-A*h,F=e*M-n*C+r*x,D=o*M-i*C+a*x,O=f*B-l*E+A*g,L=u*B-h*E+d*g;return c*F-s*D+p*O-m*L}function qt(t,e,n){let r=e[0],s=e[1],o=e[2],i=e[3],a=e[4],c=e[5],f=e[6],l=e[7],A=e[8],m=e[9],u=e[10],h=e[11],d=e[12],p=e[13],g=e[14],E=e[15],B=n[0],x=n[1],C=n[2],M=n[3];return t[0]=B*r+x*a+C*A+M*d,t[1]=B*s+x*c+C*m+M*p,t[2]=B*o+x*f+C*u+M*g,t[3]=B*i+x*l+C*h+M*E,B=n[4],x=n[5],C=n[6],M=n[7],t[4]=B*r+x*a+C*A+M*d,t[5]=B*s+x*c+C*m+M*p,t[6]=B*o+x*f+C*u+M*g,t[7]=B*i+x*l+C*h+M*E,B=n[8],x=n[9],C=n[10],M=n[11],t[8]=B*r+x*a+C*A+M*d,t[9]=B*s+x*c+C*m+M*p,t[10]=B*o+x*f+C*u+M*g,t[11]=B*i+x*l+C*h+M*E,B=n[12],x=n[13],C=n[14],M=n[15],t[12]=B*r+x*a+C*A+M*d,t[13]=B*s+x*c+C*m+M*p,t[14]=B*o+x*f+C*u+M*g,t[15]=B*i+x*l+C*h+M*E,t}function wr(t,e,n){let r=n[0],s=n[1],o=n[2],i,a,c,f,l,A,m,u,h,d,p,g;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*o+e[12],t[13]=e[1]*r+e[5]*s+e[9]*o+e[13],t[14]=e[2]*r+e[6]*s+e[10]*o+e[14],t[15]=e[3]*r+e[7]*s+e[11]*o+e[15]):(i=e[0],a=e[1],c=e[2],f=e[3],l=e[4],A=e[5],m=e[6],u=e[7],h=e[8],d=e[9],p=e[10],g=e[11],t[0]=i,t[1]=a,t[2]=c,t[3]=f,t[4]=l,t[5]=A,t[6]=m,t[7]=u,t[8]=h,t[9]=d,t[10]=p,t[11]=g,t[12]=i*r+l*s+h*o+e[12],t[13]=a*r+A*s+d*o+e[13],t[14]=c*r+m*s+p*o+e[14],t[15]=f*r+u*s+g*o+e[15]),t}function Ur(t,e,n){let r=n[0],s=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Nr(t,e,n,r){let s=r[0],o=r[1],i=r[2],a=Math.sqrt(s*s+o*o+i*i),c,f,l,A,m,u,h,d,p,g,E,B,x,C,M,F,D,O,L,H,J,K,y,Se;return a<1e-6?null:(a=1/a,s*=a,o*=a,i*=a,f=Math.sin(n),c=Math.cos(n),l=1-c,A=e[0],m=e[1],u=e[2],h=e[3],d=e[4],p=e[5],g=e[6],E=e[7],B=e[8],x=e[9],C=e[10],M=e[11],F=s*s*l+c,D=o*s*l+i*f,O=i*s*l-o*f,L=s*o*l-i*f,H=o*o*l+c,J=i*o*l+s*f,K=s*i*l+o*f,y=o*i*l-s*f,Se=i*i*l+c,t[0]=A*F+d*D+B*O,t[1]=m*F+p*D+x*O,t[2]=u*F+g*D+C*O,t[3]=h*F+E*D+M*O,t[4]=A*L+d*H+B*J,t[5]=m*L+p*H+x*J,t[6]=u*L+g*H+C*J,t[7]=h*L+E*H+M*J,t[8]=A*K+d*y+B*Se,t[9]=m*K+p*y+x*Se,t[10]=u*K+g*y+C*Se,t[11]=h*K+E*y+M*Se,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Hr(t,e,n){let r=Math.sin(n),s=Math.cos(n),o=e[4],i=e[5],a=e[6],c=e[7],f=e[8],l=e[9],A=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*s+f*r,t[5]=i*s+l*r,t[6]=a*s+A*r,t[7]=c*s+m*r,t[8]=f*s-o*r,t[9]=l*s-i*r,t[10]=A*s-a*r,t[11]=m*s-c*r,t}function Jr(t,e,n){let r=Math.sin(n),s=Math.cos(n),o=e[0],i=e[1],a=e[2],c=e[3],f=e[8],l=e[9],A=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*s-f*r,t[1]=i*s-l*r,t[2]=a*s-A*r,t[3]=c*s-m*r,t[8]=o*r+f*s,t[9]=i*r+l*s,t[10]=a*r+A*s,t[11]=c*r+m*s,t}function Kr(t,e,n){let r=Math.sin(n),s=Math.cos(n),o=e[0],i=e[1],a=e[2],c=e[3],f=e[4],l=e[5],A=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*s+f*r,t[1]=i*s+l*r,t[2]=a*s+A*r,t[3]=c*s+m*r,t[4]=f*s-o*r,t[5]=l*s-i*r,t[6]=A*s-a*r,t[7]=m*s-c*r,t}function Xr(t,e){let n=e[0],r=e[1],s=e[2],o=e[3],i=n+n,a=r+r,c=s+s,f=n*i,l=r*i,A=r*a,m=s*i,u=s*a,h=s*c,d=o*i,p=o*a,g=o*c;return t[0]=1-A-h,t[1]=l+g,t[2]=m-p,t[3]=0,t[4]=l-g,t[5]=1-f-h,t[6]=u+d,t[7]=0,t[8]=m+p,t[9]=u-d,t[10]=1-f-A,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jr(t,e,n,r,s,o,i){let a=1/(n-e),c=1/(s-r),f=1/(o-i);return t[0]=o*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(s+r)*c,t[10]=(i+o)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*f,t[15]=0,t}function fi(t,e,n,r,s){let o=1/Math.tan(e/2);if(t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0){let i=1/(r-s);t[10]=(s+r)*i,t[14]=2*s*r*i}else t[10]=-1,t[14]=-2*r;return t}var Vr=fi;function li(t,e,n,r,s,o,i){let a=1/(e-n),c=1/(r-s),f=1/(o-i);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(e+n)*a,t[13]=(s+r)*c,t[14]=(i+o)*f,t[15]=1,t}var kr=li;function Qr(t,e,n,r){let s,o,i,a,c,f,l,A,m,u,h=e[0],d=e[1],p=e[2],g=r[0],E=r[1],B=r[2],x=n[0],C=n[1],M=n[2];return Math.abs(h-x)<1e-6&&Math.abs(d-C)<1e-6&&Math.abs(p-M)<1e-6?ci(t):(A=h-x,m=d-C,u=p-M,s=1/Math.sqrt(A*A+m*m+u*u),A*=s,m*=s,u*=s,o=E*u-B*m,i=B*A-g*u,a=g*m-E*A,s=Math.sqrt(o*o+i*i+a*a),s?(s=1/s,o*=s,i*=s,a*=s):(o=0,i=0,a=0),c=m*a-u*i,f=u*o-A*a,l=A*i-m*o,s=Math.sqrt(c*c+f*f+l*l),s?(s=1/s,c*=s,f*=s,l*=s):(c=0,f=0,l=0),t[0]=o,t[1]=c,t[2]=A,t[3]=0,t[4]=i,t[5]=f,t[6]=m,t[7]=0,t[8]=a,t[9]=l,t[10]=u,t[11]=0,t[12]=-(o*h+i*d+a*p),t[13]=-(c*h+f*d+l*p),t[14]=-(A*h+m*d+u*p),t[15]=1,t)}function Ai(){let t=new I(4);return I!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Yr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Wr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function zr(t){let e=t[0],n=t[1],r=t[2],s=t[3];return Math.sqrt(e*e+n*n+r*r+s*s)}function qr(t){let e=t[0],n=t[1],r=t[2],s=t[3];return e*e+n*n+r*r+s*s}function Zr(t,e){let n=e[0],r=e[1],s=e[2],o=e[3],i=n*n+r*r+s*s+o*o;return i>0&&(i=1/Math.sqrt(i)),t[0]=n*i,t[1]=r*i,t[2]=s*i,t[3]=o*i,t}function $r(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function es(t,e,n,r){let s=e[0],o=e[1],i=e[2],a=e[3];return t[0]=s+r*(n[0]-s),t[1]=o+r*(n[1]-o),t[2]=i+r*(n[2]-i),t[3]=a+r*(n[3]-a),t}function ts(t,e,n){let r=e[0],s=e[1],o=e[2],i=e[3];return t[0]=n[0]*r+n[4]*s+n[8]*o+n[12]*i,t[1]=n[1]*r+n[5]*s+n[9]*o+n[13]*i,t[2]=n[2]*r+n[6]*s+n[10]*o+n[14]*i,t[3]=n[3]*r+n[7]*s+n[11]*o+n[15]*i,t}function ns(t,e,n){let r=e[0],s=e[1],o=e[2],i=n[0],a=n[1],c=n[2],f=n[3],l=f*r+a*o-c*s,A=f*s+c*r-i*o,m=f*o+i*s-a*r,u=-i*r-a*s-c*o;return t[0]=l*f+u*-i+A*-c-m*-a,t[1]=A*f+u*-a+m*-i-l*-c,t[2]=m*f+u*-c+l*-a-A*-i,t[3]=e[3],t}var oA=function(){let t=Ai();return function(e,n,r,s,o,i){let a,c;for(n||(n=4),r||(r=0),s?c=Math.min(s*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,i),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}();var en;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(en||(en={}));var ui=45*Math.PI/180,hi=1,Zt=.1,$t=500,di=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),$=class extends xe{static get IDENTITY(){return Bi()}static get ZERO(){return pi()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return en}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,s,o,i,a,c,f,l,A,m,u,h,d,p){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=o,this[5]=i,this[6]=a,this[7]=c,this[8]=f,this[9]=l,this[10]=A,this[11]=m,this[12]=u,this[13]=h,this[14]=d,this[15]=p,this.check()}setRowMajor(e,n,r,s,o,i,a,c,f,l,A,m,u,h,d,p){return this[0]=e,this[1]=o,this[2]=f,this[3]=u,this[4]=n,this[5]=i,this[6]=l,this[7]=h,this[8]=r,this[9]=a,this[10]=A,this[11]=d,this[12]=s,this[13]=c,this[14]=m,this[15]=p,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(di)}fromObject(e){return this.check()}fromQuaternion(e){return Xr(this,e),this.check()}frustum(e){let{left:n,right:r,bottom:s,top:o,near:i=Zt,far:a=$t}=e;return a===1/0?gi(this,n,r,s,o,i):jr(this,n,r,s,o,i,a),this.check()}lookAt(e){let{eye:n,center:r=[0,0,0],up:s=[0,1,0]}=e;return Qr(this,n,r,s),this.check()}ortho(e){let{left:n,right:r,bottom:s,top:o,near:i=Zt,far:a=$t}=e;return kr(this,n,r,s,o,i,a),this.check()}orthographic(e){let{fovy:n=ui,aspect:r=hi,focalDistance:s=1,near:o=Zt,far:i=$t}=e;rs(n);let a=n/2,c=s*Math.tan(a),f=c*r;return this.ortho({left:-f,right:f,bottom:-c,top:c,near:o,far:i})}perspective(e){let{fovy:n=45*Math.PI/180,aspect:r=1,near:s=.1,far:o=500}=e;return rs(n),Vr(this,n,r,s,o),this.check()}determinant(){return Pr(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];let r=this.getScale(n),s=1/r[0],o=1/r[1],i=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*o,e[2]=this[2]*i,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*o,e[6]=this[6]*i,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*o,e[10]=this[10]*i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];let r=this.getScale(n),s=1/r[0],o=1/r[1],i=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*o,e[2]=this[2]*i,e[3]=this[4]*s,e[4]=this[5]*o,e[5]=this[6]*i,e[6]=this[8]*s,e[7]=this[9]*o,e[8]=this[10]*i,e}transpose(){return Gr(this,this),this.check()}invert(){return vr(this,this),this.check()}multiplyLeft(e){return qt(this,e,this),this.check()}multiplyRight(e){return qt(this,this,e),this.check()}rotateX(e){return Hr(this,this,e),this.check()}rotateY(e){return Jr(this,this,e),this.check()}rotateZ(e){return Kr(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Nr(this,this,e,n),this.check()}scale(e){return Ur(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return wr(this,this,e),this.check()}transform(e,n){return e.length===4?(n=ts(n||[-0,-0,-0,-0],e,this),se(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){let{length:r}=e,s;switch(r){case 2:s=Br(n||[-0,-0],e,this);break;case 3:s=Be(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return se(s,e.length),s}transformAsVector(e,n){let r;switch(e.length){case 2:r=gr(n||[-0,-0],e,this);break;case 3:r=at(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return se(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}},dt,pt;function pi(){return dt||(dt=new $([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(dt)),dt}function Bi(){return pt||(pt=new $,Object.freeze(pt)),pt}function rs(t){if(t>Math.PI*2)throw Error("expected radians")}function gi(t,e,n,r,s,o){let i=2*o/(n-e),a=2*o/(s-r),c=(n+e)/(n-e),f=(s+r)/(s-r),l=-1,A=-1,m=-2*o;return t[0]=i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=c,t[9]=f,t[10]=l,t[11]=A,t[12]=0,t[13]=0,t[14]=m,t[15]=0,t}function ss(){let t=new I(4);return I!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function os(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function tn(t,e,n){n=n*.5;let r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function nn(t,e,n){let r=e[0],s=e[1],o=e[2],i=e[3],a=n[0],c=n[1],f=n[2],l=n[3];return t[0]=r*l+i*a+s*f-o*c,t[1]=s*l+i*c+o*a-r*f,t[2]=o*l+i*f+r*c-s*a,t[3]=i*l-r*a-s*c-o*f,t}function is(t,e,n){n*=.5;let r=e[0],s=e[1],o=e[2],i=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*a,t[1]=s*c+o*a,t[2]=o*c-s*a,t[3]=i*c-r*a,t}function as(t,e,n){n*=.5;let r=e[0],s=e[1],o=e[2],i=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c-o*a,t[1]=s*c+i*a,t[2]=o*c+r*a,t[3]=i*c-s*a,t}function cs(t,e,n){n*=.5;let r=e[0],s=e[1],o=e[2],i=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+s*a,t[1]=s*c-r*a,t[2]=o*c+i*a,t[3]=i*c-o*a,t}function fs(t,e){let n=e[0],r=e[1],s=e[2];return t[0]=n,t[1]=r,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-s*s)),t}function ve(t,e,n,r){let s=e[0],o=e[1],i=e[2],a=e[3],c=n[0],f=n[1],l=n[2],A=n[3],m,u,h,d,p;return m=s*c+o*f+i*l+a*A,m<0&&(m=-m,c=-c,f=-f,l=-l,A=-A),1-m>1e-6?(u=Math.acos(m),p=Math.sin(u),h=Math.sin((1-r)*u)/p,d=Math.sin(r*u)/p):(h=1-r,d=r),t[0]=h*s+d*c,t[1]=h*o+d*f,t[2]=h*i+d*l,t[3]=h*a+d*A,t}function ls(t,e){let n=e[0],r=e[1],s=e[2],o=e[3],i=n*n+r*r+s*s+o*o,a=i?1/i:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-s*a,t[3]=o*a,t}function As(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function rn(t,e){let n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);let o=(s+1)%3,i=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[o*3+o]-e[i*3+i]+1),t[s]=.5*r,r=.5/r,t[3]=(e[o*3+i]-e[i*3+o])*r,t[o]=(e[o*3+s]+e[s*3+o])*r,t[i]=(e[i*3+s]+e[s*3+i])*r}return t}var ms=Yr;var us=Wr,hs=$r,ds=es,ps=zr;var Bs=qr;var gs=Zr;var xs=function(){let t=jt(),e=Vt(1,0,0),n=Vt(0,1,0);return function(r,s,o){let i=kt(s,o);return i<-.999999?(pe(t,e,s),br(t)<1e-6&&pe(t,n,s),Er(t,t),tn(r,t,Math.PI),r):i>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(pe(t,s,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+i,gs(r,r))}}(),xA=function(){let t=ss(),e=ss();return function(n,r,s,o,i,a){return ve(t,r,i,a),ve(e,s,o,a),ve(n,t,e,2*a*(1-a)),n}}(),CA=function(){let t=Rr();return function(e,n,r,s){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],gs(e,rn(e,t))}}();var xi=[0,0,0,1],Pe=class extends re{constructor(e=0,n=0,r=0,s=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,s)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,s){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return rn(this,e),this.check()}fromAxisRotation(e,n){return tn(this,e,n),this.check()}identity(){return os(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=_(e)}get y(){return this[1]}set y(e){this[1]=_(e)}get z(){return this[2]}set z(e){this[2]=_(e)}get w(){return this[3]}set w(e){this[3]=_(e)}len(){return ps(this)}lengthSquared(){return Bs(this)}dot(e){return hs(this,e)}rotationTo(e,n){return xs(this,e,n),this.check()}add(e){return ms(this,this,e),this.check()}calculateW(){return fs(this,this),this.check()}conjugate(){return As(this,this),this.check()}invert(){return ls(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(ds(this,e,n,r),this.check())}multiplyRight(e){return nn(this,this,e),this.check()}multiplyLeft(e){return nn(this,e,this),this.check()}normalize(){let e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return is(this,this,e),this.check()}rotateY(e){return as(this,this,e),this.check()}rotateZ(e){return cs(this,this,e),this.check()}scale(e){return us(this,this,e),this.check()}slerp(e,n,r){let s,o,i;switch(arguments.length){case 1:({start:s=xi,target:o,ratio:i}=e);break;case 2:s=this,o=e,i=n;break;default:s=e,o=n,i=r}return ve(this,s,o,i),this.check()}transformVector4(e,n=new ge){return ns(n,e,this),se(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}};var sn=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
vec3 color;
};
struct PointLight {
vec3 color;
vec3 position;
vec3 attenuation;
};
struct DirectionalLight {
vec3 color;
vec3 direction;
};
uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;
uniform bool lighting_uEnabled;
float getPointLightAttenuation(PointLight pointLight, float distance) {
return pointLight.attenuation.x
+ pointLight.attenuation.y * distance
+ pointLight.attenuation.z * distance * distance;
}
#endif
`;var Ci={lightSources:{}};function on(t={}){let{color:e=[0,0,0],intensity:n=1}=t;return e.map(r=>r*n/255)}function Ei({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){let r={};return t?r["lighting_uAmbientLight.color"]=on(t):r["lighting_uAmbientLight.color"]=[0,0,0],e.forEach((s,o)=>{r[`lighting_uPointLight[${o}].color`]=on(s),r[`lighting_uPointLight[${o}].position`]=s.position,r[`lighting_uPointLight[${o}].attenuation`]=s.attenuation||[1,0,0]}),r.lighting_uPointLightCount=e.length,n.forEach((s,o)=>{r[`lighting_uDirectionalLight[${o}].color`]=on(s),r[`lighting_uDirectionalLight[${o}].direction`]=s.direction}),r.lighting_uDirectionalLightCount=n.length,r}function Cs(t=Ci){if("lightSources"in t){let{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},Ei({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){let e={pointLights:[],directionalLights:[]};for(let n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights?.push(n);break;case"point":e.pointLights?.push(n);break;default:}return Cs({lightSources:e})}return{}}var Es={name:"lights",vs:sn,fs:sn,getUniforms:Cs,defines:{MAX_LIGHTS:3}};var Ms=`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;
out vec3 pbr_vPosition;
out vec2 pbr_vUV;
#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
out mat3 pbr_vTBN;
# else
out vec3 pbr_vNormal;
# endif
#endif
void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
vec4 pos = u_ModelMatrix * position;
pbr_vPosition = vec3(pos.xyz) / pos.w;
#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif
#ifdef HAS_UV
pbr_vUV = uv;
#else
pbr_vUV = vec2(0.,0.);
#endif
}
`;var _s=`precision highp float;
uniform bool pbr_uUnlit;
#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif
#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif
#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif
uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;
uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif
in vec3 pbr_vPosition;
in vec2 pbr_vUV;
#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
in mat3 pbr_vTBN;
#else
in vec3 pbr_vNormal;
#endif
#endif
struct PBRInfo
{
float NdotL;
float NdotV;
float NdotH;
float LdotH;
float VdotH;
float perceptualRoughness;
float metalness;
vec3 reflectance0;
vec3 reflectance90;
float alphaRoughness;
vec3 diffuseColor;
vec3 specularColor;
vec3 n;
vec3 v;
};
const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;
vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
return vec4(linOut,srgbIn.w);;
#else
return srgbIn;
#endif
}
vec3 getNormal()
{
#ifndef HAS_TANGENTS
vec3 pos_dx = dFdx(pbr_vPosition);
vec3 pos_dy = dFdy(pbr_vPosition);
vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);
#ifdef HAS_NORMALS
vec3 ng = normalize(pbr_vNormal);
#else
vec3 ng = cross(pos_dx, pos_dy);
#endif
t = normalize(t - ng * dot(ng, t));
vec3 b = normalize(cross(ng, t));
mat3 tbn = mat3(t, b, ng);
#else
mat3 tbn = pbr_vTBN;
#endif
#ifdef HAS_NORMALMAP
vec3 n = texture(u_NormalSampler, pbr_vUV).rgb;
n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
vec3 n = normalize(tbn[2].xyz);
#endif
return n;
}
#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
float mipCount = 9.0;
float lod = (pbrInputs.perceptualRoughness * mipCount);
vec3 brdf = SRGBtoLINEAR(texture(u_brdfLUT,
vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;
#ifdef USE_TEX_LOD
vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif
vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
diffuse *= u_ScaleIBLAmbient.x;
specular *= u_ScaleIBLAmbient.y;
return diffuse + specular;
}
#endif
vec3 diffuse(PBRInfo pbrInputs)
{
return pbrInputs.diffuseColor / M_PI;
}
vec3 specularReflection(PBRInfo pbrInputs)
{
return pbrInputs.reflectance0 +
(pbrInputs.reflectance90 - pbrInputs.reflectance0) *
pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}
float geometricOcclusion(PBRInfo pbrInputs)
{
float NdotL = pbrInputs.NdotL;
float NdotV = pbrInputs.NdotV;
float r = pbrInputs.alphaRoughness;
float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
return attenuationL * attenuationV;
}
float microfacetDistribution(PBRInfo pbrInputs)
{
float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
return roughnessSq / (M_PI * f * f);
}
void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
pbrInputs.NdotL = 1.0;
pbrInputs.NdotH = 0.0;
pbrInputs.LdotH = 0.0;
pbrInputs.VdotH = 1.0;
}
void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
vec3 n = pbrInputs.n;
vec3 v = pbrInputs.v;
vec3 l = normalize(lightDirection);
vec3 h = normalize(l+v);
pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}
void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}
vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
vec3 F = specularReflection(pbrInputs);
float G = geometricOcclusion(pbrInputs);
float D = microfacetDistribution(pbrInputs);
vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}
vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
vec4 baseColor = SRGBtoLINEAR(texture(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
vec4 baseColor = u_BaseColorFactor;
#endif
#ifdef ALPHA_CUTOFF
if (baseColor.a < u_AlphaCutoff) {
discard;
}
#endif
vec3 color = vec3(0, 0, 0);
if(pbr_uUnlit){
color.rgb = baseColor.rgb;
}
else{
float perceptualRoughness = u_MetallicRoughnessValues.y;
float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP
vec4 mrSample = texture(u_MetallicRoughnessSampler, pbr_vUV);
perceptualRoughness = mrSample.g * perceptualRoughness;
metallic = mrSample.b * metallic;
#endif
perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
metallic = clamp(metallic, 0.0, 1.0);
float alphaRoughness = perceptualRoughness * perceptualRoughness;
vec3 f0 = vec3(0.04);
vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
diffuseColor *= 1.0 - metallic;
vec3 specularColor = mix(f0, baseColor.rgb, metallic);
float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);
float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
vec3 specularEnvironmentR0 = specularColor.rgb;
vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;
vec3 n = getNormal();
vec3 v = normalize(u_Camera - pbr_vPosition);
float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
vec3 reflection = -normalize(reflect(v, n));
PBRInfo pbrInputs = PBRInfo(
0.0,
NdotV,
0.0,
0.0,
0.0,
perceptualRoughness,
metallic,
specularEnvironmentR0,
specularEnvironmentR90,
alphaRoughness,
diffuseColor,
specularColor,
n,
v
);
#ifdef USE_LIGHTS
PBRInfo_setAmbientLight(pbrInputs);
color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
for(int i = 0; i < lighting_uDirectionalLightCount; i++) {
if (i < lighting_uDirectionalLightCount) {
PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
}
}
for(int i = 0; i < lighting_uPointLightCount; i++) {
if (i < lighting_uPointLightCount) {
PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
}
}
#endif
#ifdef USE_IBL
color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
float ao = texture(u_OcclusionSampler, pbr_vUV).r;
color = mix(color, color * ao, u_OcclusionStrength);
#endif
#ifdef HAS_EMISSIVEMAP
vec3 emissive = SRGBtoLINEAR(texture(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
color += emissive;
#endif
#ifdef PBR_DEBUG
color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif
}
return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`;var we={name:"pbr",vs:Ms,fs:_s,defines:{LIGHTING_FRAGMENT:1},dependencies:[Es]};var Ae=G(De(),1);var Ts=G(Fe(),1),X;(function(t){t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.ONE=1]="ONE",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.LINEAR=9729]="LINEAR",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL"})(X||(X={}));function ys(t,e,n,r){let s={defines:{MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},bindings:{},uniforms:{u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},parameters:{},glParameters:{},generatedTextures:[]};s.defines.USE_TEX_LOD=1;let{imageBasedLightingEnvironment:o}=r;return o&&(s.bindings.u_DiffuseEnvSampler=o.diffuseEnvSampler,s.bindings.u_SpecularEnvSampler=o.specularEnvSampler,s.bindings.u_brdfLUT=o.brdfLutTexture,s.uniforms.u_ScaleIBLAmbient=[1,1]),r?.pbrDebug&&(s.defines.PBR_DEBUG=1,s.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],s.uniforms.u_ScaleFGDSpec=[0,0,0,0]),n.NORMAL&&(s.defines.HAS_NORMALS=1),n.TANGENT&&r?.useTangents&&(s.defines.HAS_TANGENTS=1),n.TEXCOORD_0&&(s.defines.HAS_UV=1),r?.imageBasedLightingEnvironment&&(s.defines.USE_IBL=1),r?.lights&&(s.defines.USE_LIGHTS=1),e&&Mi(t,e,s),s}function Mi(t,e,n){if(n.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&_i(t,e.pbrMetallicRoughness,n),e.normalTexture){Ue(t,e.normalTexture,"u_NormalSampler","HAS_NORMALMAP",n);let{scale:r=1}=e.normalTexture;n.uniforms.u_NormalScale=r}if(e.occlusionTexture){Ue(t,e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP",n);let{strength:r=1}=e.occlusionTexture;n.uniforms.u_OcclusionStrength=r}switch(e.emissiveTexture&&(Ue(t,e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP",n),n.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode){case"MASK":let{alphaCutoff:r=.5}=e;n.defines.ALPHA_CUTOFF=1,n.uniforms.u_AlphaCutoff=r;break;case"BLEND":Ts.log.warn("glTF BLEND alphaMode might not work well because it requires mesh sorting")(),n.parameters.blendColorOperation="add",n.parameters.blendColorSrcFactor="src-alpha",n.parameters.blendColorDstFactor="one-minus-src-alpha",n.parameters.blendAlphaOperation="add",n.parameters.blendAlphaSrcFactor="one",n.parameters.blendAlphaDstFactor="one-minus-src-alpha",n.glParameters.blend=!0,n.glParameters.blendEquation=X.FUNC_ADD,n.glParameters.blendFunc=[X.SRC_ALPHA,X.ONE_MINUS_SRC_ALPHA,X.ONE,X.ONE_MINUS_SRC_ALPHA];break}}function _i(t,e,n){e.baseColorTexture&&Ue(t,e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP",n),n.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&Ue(t,e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP",n);let{metallicFactor:r=1,roughnessFactor:s=1}=e;n.uniforms.u_MetallicRoughnessValues=[r,s]}function Ue(t,e,n,r=null,s){let o=e?.texture?.sampler?.parameters||{},i=e.texture.source.image,a,c={};i.compressed?(a=i,c={[X.TEXTURE_MIN_FILTER]:i.data.length>1?X.LINEAR_MIPMAP_NEAREST:X.LINEAR}):a={data:i};let f=t.createTexture({id:e.uniformName||e.id,parameters:{...o,...c},pixelStore:{[X.UNPACK_FLIP_Y_WEBGL]:!1},...a});s.bindings[n]=f,r&&(s.defines[r]=1),s.generatedTextures.push(f)}var bs="4.1.4";function Ti(){var t;return(t=globalThis._loadersgl_)!==null&&t!==void 0&&t.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.1.4"),globalThis._loadersgl_.version}var Rs=Ti();function Is(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}var k={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},YA=k.self||k.window||k.global||{},WA=k.window||k.self||k.global||{},zA=k.global||k.self||k.window||{},qA=k.document||{};var Ce=typeof process!="object"||String(process)!=="[object process]"||process.browser,Bt=typeof importScripts=="function",ZA=typeof window<"u"&&typeof window.orientation<"u",Ss=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),$A=Ss&&parseFloat(Ss[1])||0;var an={};async function Q(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return e&&(t=Fs(t,e,n,r)),an[t]=an[t]||yi(t),await an[t]}function Fs(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!n.useLocalLibraries&&t.startsWith("http"))return t;r=r||t;let s=n.modules||{};return s[r]?s[r]:Ce?n.CDN?(Is(n.CDN.startsWith("http")),`${n.CDN}/${e}@${Rs}/dist/libs/${r}`):Bt?`../src/libs/${r}`:`modules/${e}/src/libs/${r}`:`modules/${e}/dist/libs/${r}`}async function yi(t){if(t.endsWith("wasm"))return await Ri(t);if(!Ce)try{return v&&v.requireFromFile&&await v.requireFromFile(t)}catch(n){return console.error(n),null}if(Bt)return importScripts(t);let e=await Ii(t);return bi(e,t)}function bi(t,e){if(!Ce)return v.requireFromString&&v.requireFromString(t,e);if(Bt)return eval.call(globalThis,t),null;let n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}async function Ri(t){return Ce||!v.readFileAsArrayBuffer||t.startsWith("http")?await(await fetch(t)).arrayBuffer():await v.readFileAsArrayBuffer(t)}async function Ii(t){return Ce||!v.readFileAsText||t.startsWith("http")?await(await fetch(t)).text():await v.readFileAsText(t)}var gt={TRANSCODER:"basis_transcoder.js",TRANSCODER_WASM:"basis_transcoder.wasm",ENCODER:"basis_encoder.js",ENCODER_WASM:"basis_encoder.wasm"},cn;async function ln(t){let e=t.modules||{};return e.basis?e.basis:(cn=cn||Si(t),await cn)}async function Si(t){let e=null,n=null;return[e,n]=await Promise.all([await Q(gt.TRANSCODER,"textures",t),await Q(gt.TRANSCODER_WASM,"textures",t)]),e=e||globalThis.BASIS,await Fi(e,n)}function Fi(t,e){let n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(s=>{let{BasisFile:o,initializeBasis:i}=s;i(),r({BasisFile:o})})})}var fn;async function An(t){let e=t.modules||{};return e.basisEncoder?e.basisEncoder:(fn=fn||Di(t),await fn)}async function Di(t){let e=null,n=null;return[e,n]=await Promise.all([await Q(gt.ENCODER,"textures",t),await Q(gt.ENCODER_WASM,"textures",t)]),e=e||globalThis.BASIS,await Oi(e,n)}function Oi(t,e){let n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(s=>{let{BasisFile:o,KTX2File:i,initializeBasis:a,BasisEncoder:c}=s;a(),r({BasisFile:o,KTX2File:i,BasisEncoder:c})})})}var ce={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919};var Li=["","WEBKIT_","MOZ_"],Ds={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"},xt=null;function Os(t){if(!xt){t=t||Gi()||void 0,xt=new Set;for(let e of Li)for(let n in Ds)if(t&&t.getExtension(`${e}${n}`)){let r=Ds[n];xt.add(r)}}return xt}function Gi(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var Am=new Uint8Array([0]);var Ls,Gs,vs,Ps,ws,Us,Ns,Hs;(function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"})(Ls||(Ls={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(Gs||(Gs={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(vs||(vs={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(Ps||(Ps={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(ws||(ws={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(Us||(Us={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(Ns||(Ns={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(Hs||(Hs={}));var P=[171,75,84,88,32,50,48,187,13,10,26,10];function Js(t){let e=new Uint8Array(t);return!(e.byteLength<P.length||e[0]!==P[0]||e[1]!==P[1]||e[2]!==P[2]||e[3]!==P[3]||e[4]!==P[4]||e[5]!==P[5]||e[6]!==P[6]||e[7]!==P[7]||e[8]!==P[8]||e[9]!==P[9]||e[10]!==P[10]||e[11]!==P[11])}var vi={etc1:{basisFormat:0,compressed:!0,format:ce.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:ce.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:ce.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:ce.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:ce.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:ce.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function un(t,e){if(e.basis.containerFormat==="auto"){if(Js(t)){let r=await An(e);return Ks(r.KTX2File,t,e)}let{BasisFile:n}=await ln(e);return mn(n,t,e)}switch(e.basis.module){case"encoder":let n=await An(e);switch(e.basis.containerFormat){case"ktx2":return Ks(n.KTX2File,t,e);case"basis":default:return mn(n.BasisFile,t,e)}case"transcoder":default:let{BasisFile:r}=await ln(e);return mn(r,t,e)}}function mn(t,e,n){let r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");let s=r.getNumImages(),o=[];for(let i=0;i<s;i++){let a=r.getNumLevels(i),c=[];for(let f=0;f<a;f++)c.push(Pi(r,i,f,n));o.push(c)}return o}finally{r.close(),r.delete()}}function Pi(t,e,n,r){let s=t.getImageWidth(e,n),o=t.getImageHeight(e,n),i=t.getHasAlpha(),{compressed:a,format:c,basisFormat:f}=Xs(r,i),l=t.getImageTranscodedSizeInBytes(e,n,f),A=new Uint8Array(l);if(!t.transcodeImage(A,e,n,f,0,0))throw new Error("failed to start Basis transcoding");return{width:s,height:o,data:A,compressed:a,format:c,hasAlpha:i}}function Ks(t,e,n){let r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");let s=r.getLevels(),o=[];for(let i=0;i<s;i++){o.push(wi(r,i,n));break}return[o]}finally{r.close(),r.delete()}}function wi(t,e,n){let{alphaFlag:r,height:s,width:o}=t.getImageLevelInfo(e,0,0),{compressed:i,format:a,basisFormat:c}=Xs(n,r),f=t.getImageTranscodedSizeInBytes(e,0,0,c),l=new Uint8Array(f);if(!t.transcodeImage(l,e,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:o,height:s,data:l,compressed:i,levelSize:f,hasAlpha:r,format:a}}function Xs(t,e){let n=t&&t.basis&&t.basis.format;return n==="auto"&&(n=Ct()),typeof n=="object"&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),vi[n]}function Ct(){let t=Os();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}var js={name:"Basis",id:"basis",module:"textures",version:bs,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},hn={...js,parse:un};async function Ne(t,e,n,r){return r._parse(t,e,n,r)}function U(t,e){if(!t)throw new Error(e||"loader assertion failed.")}var Y={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},Ui=Y.self||Y.window||Y.global||{},Ni=Y.window||Y.self||Y.global||{},Hi=Y.global||Y.self||Y.window||{},Ji=Y.document||{};var He=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser);var Vs=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),Ki=Vs&&parseFloat(Vs[1])||0;function Qs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?ks(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?ks(t,0,e):""}function ks(t,e,n){if(t.byteLength<=e+n)return"";let r=new DataView(t),s="";for(let o=0;o<n;o++)s+=String.fromCharCode(r.getUint8(e+o));return s}function dn(t){try{return JSON.parse(t)}catch{throw new Error(`Failed to parse JSON from data starting with "${Qs(t)}"`)}}function Je(t,e,n){let r=n!==void 0?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function oe(t,e){return U(t>=0),U(e>0),t+(e-1)&~(e-1)}function pn(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{let s=t.byteOffset,o=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,s,o)}return e.set(r,n),n+oe(r.byteLength,4)}var Ys="4.1.4";var Bn,Xi=(Bn=globalThis.loaders)===null||Bn===void 0?void 0:Bn.parseImageNode,gn=typeof Image<"u",xn=typeof ImageBitmap<"u",ji=Boolean(Xi),Cn=He?!0:ji;function Ws(t){switch(t){case"auto":return xn||gn||Cn;case"imagebitmap":return xn;case"image":return gn;case"data":return Cn;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function zs(){if(xn)return"imagebitmap";if(gn)return"image";if(Cn)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function qs(t){let e=Vi(t);if(!e)throw new Error("Not an image");return e}function Ke(t){switch(qs(t)){case"data":return t;case"image":case"imagebitmap":let e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Vi(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}var ki=/^data:image\/svg\+xml/,Qi=/\.svg((\?|#).*)?$/;function Et(t){return t&&(ki.test(t)||Qi.test(t))}function Zs(t,e){if(Et(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(o){throw new Error(o.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return En(t,e)}function En(t,e){if(Et(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Mt(t,e,n){let r=Zs(t,n),s=self.URL||self.webkitURL,o=typeof r!="string"&&s.createObjectURL(r);try{return await Yi(o||r,e)}finally{o&&s.revokeObjectURL(o)}}async function Yi(t,e){let n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,s)=>{try{n.onload=()=>r(n),n.onerror=o=>{let i=o instanceof Error?o.message:"error";s(new Error(i))}}catch(o){s(o)}})}var Wi={},$s=!0;async function eo(t,e,n){let r;Et(n)?r=await Mt(t,e,n):r=En(t,n);let s=e&&e.imagebitmap;return await zi(r,s)}async function zi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((qi(e)||!$s)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),$s=!1}return await createImageBitmap(t)}function qi(t){for(let e in t||Wi)return!1;return!0}function to(t){return!ta(t,"ftyp",4)||!(t[8]&96)?null:Zi(t)}function Zi(t){switch($i(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function $i(t,e,n){return String.fromCharCode(...t.slice(e,n))}function ea(t){return[...t].map(e=>e.charCodeAt(0))}function ta(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=ea(e);for(let s=0;s<r.length;++s)if(r[s]!==t[s+n])return!1;return!0}var W=!1,Xe=!0;function fe(t){let e=je(t);return ra(e)||ia(e)||sa(e)||oa(e)||na(e)}function na(t){let e=new Uint8Array(t instanceof DataView?t.buffer:t),n=to(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function ra(t){let e=je(t);return e.byteLength>=24&&e.getUint32(0,W)===2303741511?{mimeType:"image/png",width:e.getUint32(16,W),height:e.getUint32(20,W)}:null}function sa(t){let e=je(t);return e.byteLength>=10&&e.getUint32(0,W)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Xe),height:e.getUint16(8,Xe)}:null}function oa(t){let e=je(t);return e.byteLength>=14&&e.getUint16(0,W)===16973&&e.getUint32(2,Xe)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Xe),height:e.getUint32(22,Xe)}:null}function ia(t){let e=je(t);if(!(e.byteLength>=3&&e.getUint16(0,W)===65496&&e.getUint8(2)===255))return null;let{tableMarkers:r,sofMarkers:s}=aa(),o=2;for(;o+9<e.byteLength;){let i=e.getUint16(o,W);if(s.has(i))return{mimeType:"image/jpeg",height:e.getUint16(o+5,W),width:e.getUint16(o+7,W)};if(!r.has(i))return null;o+=2,o+=e.getUint16(o,W)}return null}function aa(){let t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function je(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function no(t,e){var n;let{mimeType:r}=fe(t)||{},s=(n=globalThis.loaders)===null||n===void 0?void 0:n.parseImageNode;return U(s),await s(t,r)}async function ro(t,e,n){e=e||{};let s=(e.image||{}).type||"auto",{url:o}=n||{},i=ca(s),a;switch(i){case"imagebitmap":a=await eo(t,e,o);break;case"image":a=await Mt(t,e,o);break;case"data":a=await no(t,e);break;default:U(!1)}return s==="data"&&(a=Ke(a)),a}function ca(t){switch(t){case"auto":case"data":return zs();default:return Ws(t),t}}var fa=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],la=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],Aa={image:{type:"auto",decode:!0}},Mn={id:"image",module:"images",name:"Images",version:Ys,mimeTypes:la,extensions:fa,parse:ro,tests:[t=>Boolean(fe(new DataView(t)))],options:Aa};var _n={};function Tn(t){if(_n[t]===void 0){let e=He?ua(t):ma(t);_n[t]=e}return _n[t]}function ma(t){var e,n;let r=["image/png","image/jpeg","image/gif"],s=((e=globalThis.loaders)===null||e===void 0?void 0:e.imageFormatsNode)||r,o=(n=globalThis.loaders)===null||n===void 0?void 0:n.parseImageNode;return Boolean(o)&&s.includes(t)}function ua(t){switch(t){case"image/avif":case"image/webp":return ha(t);default:return!0}}function ha(t){try{return document.createElement("canvas").toDataURL(t).indexOf(`data:${t}`)===0}catch{return!1}}var Ee=G(De(),1);var Ve=G(Fe(),1);var da={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},pa={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},bn=class{name;startTime=0;playing=!0;speed=1;channels=[];constructor(e){Object.assign(this,e)}animate(e){if(!this.playing)return;let r=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:s,target:o,path:i})=>{Ma(r,s,o,i),ga(o,o._node)})}},_t=class{animations;constructor(e){this.animations=e.animations.map((n,r)=>{let s=n.name||`Animation-${r}`,o=n.samplers.map(({input:a,interpolation:c="LINEAR",output:f})=>({input:so(e.accessors[a]),interpolation:c,output:so(e.accessors[f])})),i=n.channels.map(({sampler:a,target:c})=>({sampler:o[a],target:e.nodes[c.node],path:c.path}));return new bn({name:s,channels:i})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(n=>n.animate(e))}getAnimations(){return this.animations}};function so(t){if(!t._animation){let e=pa[t.componentType],n=da[t.type],r=n*t.count,{buffer:s,byteOffset:o}=t.bufferView.data,i=new e(s,o+(t.byteOffset||0),r);if(n===1)t._animation=Array.from(i);else{let a=[];for(let c=0;c<i.length;c+=n)a.push(Array.from(i.slice(c,c+n)));t._animation=a}}return t._animation}var Ba=new $;function ga(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){let n=Ba.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}var yn=new Pe;function xa(t,e,n,r,s){if(e==="rotation"){yn.slerp({start:n,target:r,ratio:s});for(let o=0;o<yn.length;o++)t[e][o]=yn[o]}else for(let o=0;o<n.length;o++)t[e][o]=s*r[o]+(1-s)*n[o]}function Ca(t,e,{p0:n,outTangent0:r,inTangent1:s,p1:o,tDiff:i,ratio:a}){for(let c=0;c<t[e].length;c++){let f=r[c]*i,l=s[c]*i;t[e][c]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*n[c]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*f+(-2*Math.pow(a,3)+3*Math.pow(a,2))*o[c]+(Math.pow(a,3)-Math.pow(a,2))*l}}function Ea(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}function Ma(t,{input:e,interpolation:n,output:r},s,o){let i=e[e.length-1],a=t%i,c=e.findIndex(m=>m>=a),f=Math.max(0,c-1);if(!Array.isArray(s[o]))switch(o){case"translation":s[o]=[0,0,0];break;case"rotation":s[o]=[0,0,0,1];break;case"scale":s[o]=[1,1,1];break;default:Ve.log.warn(`Bad animation path ${o}`)()}(0,Ve.assert)(s[o].length===r[f].length);let l=e[f],A=e[c];switch(n){case"STEP":Ea(s,o,r[f]);break;case"LINEAR":if(A>l){let m=(a-l)/(A-l);xa(s,o,r[f],r[c],m)}break;case"CUBICSPLINE":if(A>l){let m=(a-l)/(A-l),u=A-l,h=r[3*f+1],d=r[3*f+2],p=r[3*c+0],g=r[3*c+1];Ca(s,o,{p0:h,outTangent0:d,inTangent1:p,p1:g,tDiff:u,ratio:m})}break;default:Ve.log.warn(`Interpolation ${n} not supported`)();break}}var io=G(Fe(),1);var Tt=G(De(),1);var _a=`
#pragma vscode_glsllint_stage: vert
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  // _attr vec4 POSITION;
  _attr vec4 positions;

  #ifdef HAS_NORMALS
    // _attr vec4 NORMAL;
    _attr vec4 normals;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    // _attr vec2 TEXCOORD_0;
    _attr vec2 texCoords;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = normals;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = texCoords;
    #endif

    pbr_setPositionNormalTangentUV(positions, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * positions;
  }
`,Ta=`
#pragma vscode_glsllint_stage: frag
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    vec3 pos = pbr_vPosition;
    fragmentColor = pbr_filterColor(vec4(1.0));
  }
`;function ao(t,e){let{id:n,geometry:r,material:s,vertexCount:o,materialOptions:i,modelOptions:a}=e,c=ys(t,s,r.attributes,i);io.log.info(4,"createGLTFModel defines: ",c.defines)();let f=[],l={depthWriteEnabled:!0,depthCompare:"less",depthFormat:"depth24plus",cullMode:"back"},A={id:n,geometry:r,topology:r.topology,vertexCount:o,modules:[we],vs:oo(t,_a),fs:oo(t,Ta),...a,bindings:{...c.bindings,...a.bindings},defines:{...c.defines,...a.defines},parameters:{...l,...c.parameters,...a.parameters},uniforms:{...c.uniforms,...a.uniforms}},m=new Tt.Model(t,A);return new Tt.ModelNode({managedResources:f,model:m})}function oo(t,e){return`#version 300 es
${e}`}var ya={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},yt=class{device;options;gltf;constructor(e,n={}){this.device=e,this.options={...ya,...n}}instantiate(e){return this.gltf=e,(e.scenes||[]).map(r=>this.createScene(r))}createAnimator(){return Array.isArray(this.gltf.animations)?new _t(this.gltf):null}createScene(e){let r=(e.nodes||[]).map(o=>this.createNode(o));return new Ee.GroupNode({id:e.name||e.id,children:r})}createNode(e){if(!e._node){let r=(e.children||[]).map(o=>this.createNode(o));e.mesh&&r.push(this.createMesh(e.mesh));let s=new Ee.GroupNode({id:e.name||e.id,children:r});if(e.matrix)s.setMatrix(e.matrix);else{if(s.matrix.identity(),e.translation&&s.matrix.translate(e.translation),e.rotation){let o=new $().fromQuaternion(e.rotation);s.matrix.multiplyRight(o)}e.scale&&s.matrix.scale(e.scale)}e._node=s}return e._node}createMesh(e){if(!e._mesh){let r=(e.primitives||[]).map((o,i)=>this.createPrimitive(o,i,e)),s=new Ee.GroupNode({id:e.name||e.id,children:r});e._mesh=s}return e._mesh}createPrimitive(e,n,r){let s=e.name||`${r.name||r.id}-primitive-${n}`,o=ba(e.mode||4),i=e.indices?e.indices.count:this.getVertexCount(e.attributes),a=ao(this.device,{id:s,geometry:this.createGeometry(s,e,o),material:e.material,materialOptions:this.options,modelOptions:this.options.modelOptions,vertexCount:i});return a.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],a}getVertexCount(e){throw new Error("getVertexCount not implemented")}createGeometry(e,n,r){let s={};for(let[o,i]of Object.entries(n.attributes)){let{components:a,size:c,value:f}=i;s[o]={size:c??a,value:f}}return new Ee.Geometry({id:e,topology:r,indices:n.indices.value,attributes:s})}createBuffer(e,n){e.bufferView||(e.bufferView={});let{bufferView:r}=e;return r.lumaBuffers||(r.lumaBuffers={}),r.lumaBuffers[n]||(r.lumaBuffers[n]=this.device.createBuffer({id:`from-${r.id}`,data:r.data||e.value})),r.lumaBuffers[n]}createSampler(e){return e}needsPOT(){return!1}},ee;(function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(ee||(ee={}));function ba(t){switch(t){case ee.POINTS:return"point-list";case ee.LINES:return"line-list";case ee.LINE_STRIP:return"line-strip";case ee.LINE_LOOP:return"line-loop-webgl";case ee.TRIANGLES:return"triangle-list";case ee.TRIANGLE_STRIP:return"triangle-strip";case ee.TRIANGLE_FAN:return"triangle-fan-webgl";default:throw new Error(t)}}function Rn(t,e,n){let r=new yt(t,n),s=r.instantiate(e),o=r.createAnimator();return{scenes:s,animator:o}}var In={};w(In,{decode:()=>wa,name:()=>Pa});function R(t,e){if(!t)throw new Error(e||"assert failed: gltf")}var bt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Rt={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4};var co=["SCALAR","VEC2","VEC3","VEC4"],Ra=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Ia=new Map(Ra),Sa={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Fa={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Da={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function It(t){return co[t-1]||co[0]}function Me(t){let e=Ia.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function _e(t,e){let n=Da[t.componentType],r=Sa[t.type],s=Fa[t.componentType],o=t.count*r,i=t.count*r*s;R(i>=0&&i<=e.byteLength);let a=Rt[t.componentType],c=bt[t.type];return{ArrayType:n,length:o,byteLength:i,componentByteSize:a,numberOfComponentsInElement:c}}function fo(t,e,n){let r=t.bufferViews[n];R(r);let s=r.buffer,o=e[s];R(o);let i=(r.byteOffset||0)+o.byteOffset;return new Uint8Array(o.arrayBuffer,i,r.byteLength)}function lo(t,e,n){var r,s;let o=typeof n=="number"?(r=t.accessors)===null||r===void 0?void 0:r[n]:n;if(!o)throw new Error(`No gltf accessor ${JSON.stringify(n)}`);let i=(s=t.bufferViews)===null||s===void 0?void 0:s[o.bufferView||0];if(!i)throw new Error(`No gltf buffer view for accessor ${i}`);let{arrayBuffer:a,byteOffset:c}=e[i.buffer],f=(c||0)+(o.byteOffset||0)+(i.byteOffset||0),{ArrayType:l,length:A,componentByteSize:m,numberOfComponentsInElement:u}=_e(o,i),h=m*u,d=i.byteStride||h;if(typeof i.byteStride>"u"||i.byteStride===h)return new l(a,f,A);let p=new l(A);for(let g=0;g<o.count;g++){let E=new l(a,f+g*d,u);p.set(E,g*u)}return p}function Oa(){return{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]}}var T=class{constructor(e){this.gltf=void 0,this.sourceBuffers=void 0,this.byteLength=void 0,this.gltf={json:e?.json||Oa(),buffers:e?.buffers||[],images:e?.images||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}hasExtension(e){let n=this.getUsedExtensions().find(s=>s===e),r=this.getRequiredExtensions().find(s=>s===e);return typeof n=="string"||typeof r=="string"}getExtension(e){let n=this.getUsedExtensions().find(s=>s===e),r=this.json.extensions||{};return n?r[e]:null}getRequiredExtension(e){return this.getRequiredExtensions().find(r=>r===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,n){if(typeof n=="object")return n;let r=this.json[e]&&this.json[e][n];if(!r)throw new Error(`glTF file error: Could not find ${e}[${n}]`);return r}getTypedArrayForBufferView(e){e=this.getBufferView(e);let n=e.buffer,r=this.gltf.buffers[n];R(r);let s=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,s,e.byteLength)}getTypedArrayForAccessor(e){let n=this.getAccessor(e);return lo(this.gltf.json,this.gltf.buffers,n)}getTypedArrayForImageData(e){e=this.getAccessor(e);let n=this.getBufferView(e.bufferView),s=this.getBuffer(n.buffer).data,o=n.byteOffset||0;return new Uint8Array(s,o,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,r){return e.extensions=e.extensions||{},e.extensions[n]=r,this.registerUsedExtension(n),this}setObjectExtension(e,n,r){let s=e.extensions||{};s[n]=r}removeObjectExtension(e,n){let r=e?.extensions||{};if(r[n]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];let s=this.json.extensionsRemoved;s.includes(n)||s.push(n)}delete r[n]}addExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return R(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return R(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){var n;if((n=this.json.extensions)!==null&&n!==void 0&&n[e]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];let r=this.json.extensionsRemoved;r.includes(e)||r.push(e)}this.json.extensions&&delete this.json.extensions[e],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e)}setDefaultScene(e){this.json.scene=e}addScene(e){let{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){let{meshIndex:n,matrix:r}=e;this.json.nodes=this.json.nodes||[];let s={mesh:n};return r&&(s.matrix=r),this.json.nodes.push(s),this.json.nodes.length-1}addMesh(e){let{attributes:n,indices:r,material:s,mode:o=4}=e,a={primitives:[{attributes:this._addAttributes(n),mode:o}]};if(r){let c=this._addIndices(r);a.primitives[0].indices=c}return Number.isFinite(s)&&(a.primitives[0].material=s),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){let r={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(e,n){let r=fe(e),s=n||r?.mimeType,i={bufferView:this.addBufferView(e),mimeType:s};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}addBufferView(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.byteLength,s=e.byteLength;R(Number.isFinite(s)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);let o={buffer:n,byteOffset:r,byteLength:s};return this.byteLength+=oe(s,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(o),this.json.bufferViews.length-1}addAccessor(e,n){let r={bufferView:e,type:It(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3},r=this.addBufferView(e),s={min:n.min,max:n.max};(!s.min||!s.max)&&(s=this._getAccessorMinMax(e,n.size));let o={size:n.size,componentType:Me(e),count:Math.round(e.length/n.size),min:s.min,max:s.max};return this.addAccessor(r,Object.assign(o,n))}addTexture(e){let{imageIndex:n}=e,r={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,n;this.gltf.buffers=[];let r=this.byteLength,s=new ArrayBuffer(r),o=new Uint8Array(s),i=0;for(let a of this.sourceBuffers||[])i=pn(a,o,i);(e=this.json)!==null&&e!==void 0&&(n=e.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=s,this.sourceBuffers=[s]}_removeStringFromArray(e,n){let r=!0;for(;r;){let s=e.indexOf(n);s>-1?e.splice(s,1):r=!1}}_addAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n={};for(let r in e){let s=e[r],o=this._getGltfAttributeName(r),i=this.addBinaryBuffer(s.value,s);n[o]=i}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,n){let r={min:null,max:null};if(e.length<n)return r;r.min=[],r.max=[];let s=e.subarray(0,n);for(let o of s)r.min.push(o),r.max.push(o);for(let o=n;o<e.length;o+=n)for(let i=0;i<n;i++)r.min[0+i]=Math.min(r.min[0+i],e[o+i]),r.max[0+i]=Math.max(r.max[0+i],e[o+i]);return r}};function Ao(t){return(t%1+1)%1}var mo={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},La={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},uo={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function ke(t,e){return uo[e]*mo[t]}function Te(t,e,n,r){if(n!=="UINT8"&&n!=="UINT16"&&n!=="UINT32"&&n!=="UINT64")return null;let s=t.getTypedArrayForBufferView(e),o=ye(s,"SCALAR",n,r+1);return o instanceof BigInt64Array||o instanceof BigUint64Array?null:o}function ye(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=mo[e],o=La[n],i=uo[n],a=r*s,c=a*i,f=t.buffer,l=t.byteOffset;return l%i!==0&&(f=new Uint8Array(f).slice(l,l+c).buffer,l=0),new o(f,l,a)}function be(t,e,n){var r,s;let o=`TEXCOORD_${e.texCoord||0}`,i=n.attributes[o],a=t.getTypedArrayForAccessor(i),c=t.gltf.json,f=e.index,l=(r=c.textures)===null||r===void 0||(s=r[f])===null||s===void 0?void 0:s.source;if(typeof l<"u"){var A,m,u;let h=(A=c.images)===null||A===void 0||(m=A[l])===null||m===void 0?void 0:m.mimeType,d=(u=t.gltf.images)===null||u===void 0?void 0:u[l];if(d&&typeof d.width<"u"){let p=[];for(let g=0;g<a.length;g+=2){let E=Ga(d,h,a,g,e.channels);p.push(E)}return p}}return[]}function St(t,e,n,r,s){if(!(n!=null&&n.length))return;let o=[];for(let l of n){let A=r.findIndex(m=>m===l);A===-1&&(A=r.push(l)-1),o.push(A)}let i=new Uint32Array(o),a=t.gltf.buffers.push({arrayBuffer:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength})-1,c=t.addBufferView(i,a,0),f=t.addAccessor(c,{size:1,componentType:Me(i),count:i.length});s.attributes[e]=f}function Ga(t,e,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[0],o={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},i=n[r],a=n[r+1],c=1;e&&(e.indexOf("image/jpeg")!==-1||e.indexOf("image/png")!==-1)&&(c=4);let f=va(i,a,t,c),l=0;for(let A of s){let m=typeof A=="number"?Object.values(o)[A]:o[A],u=f+m.offset,h=Ke(t);if(h.data.length<=u)throw new Error(`${h.data.length} <= ${u}`);let d=h.data[u];l|=d<<m.shift}return l}function va(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=n.width,o=Ao(t)*(s-1),i=Math.round(o),a=n.height,c=Ao(e)*(a-1),f=Math.round(c),l=n.components?n.components:r;return(f*s+i)*l}function Ft(t,e,n,r,s){let o=[];for(let i=0;i<e;i++){let a=n[i],c=n[i+1]-n[i];if(c+a>r)break;let f=a/s,l=c/s;o.push(t.slice(f,f+l))}return o}function Dt(t,e,n){let r=[];for(let s=0;s<e;s++){let o=s*n;r.push(t.slice(o,o+n))}return r}function Ot(t,e,n,r){if(n)throw new Error("Not implemented - arrayOffsets for strings is specified");if(r){let s=[],o=new TextDecoder("utf8"),i=0;for(let a=0;a<t;a++){let c=r[a+1]-r[a];if(c+i<=e.length){let f=e.subarray(i,c+i),l=o.decode(f);s.push(l),i+=c}}return s}return[]}var ho="EXT_mesh_features",Pa=ho;async function wa(t,e){let n=new T(t);Ua(n,e)}function Ua(t,e){let n=t.gltf.json;if(n.meshes)for(let r of n.meshes)for(let s of r.primitives)Na(t,s,e)}function Na(t,e,n){var r,s;if(!(n!=null&&(r=n.gltf)!==null&&r!==void 0&&r.loadBuffers))return;let o=(s=e.extensions)===null||s===void 0?void 0:s[ho],i=o?.featureIds;if(i)for(let c of i){var a;let f;if(typeof c.attribute<"u"){let l=`_FEATURE_ID_${c.attribute}`,A=e.attributes[l];f=t.getTypedArrayForAccessor(A)}else typeof c.texture<"u"&&n!==null&&n!==void 0&&(a=n.gltf)!==null&&a!==void 0&&a.loadImages?f=be(t,c.texture,e):f=[];c.data=f}}var Dn={};w(Dn,{decode:()=>Ja,name:()=>Ha});var Sn="EXT_structural_metadata",Ha=Sn;async function Ja(t,e){let n=new T(t);Ka(n,e)}function Ka(t,e){var n,r;if(!((n=e.gltf)!==null&&n!==void 0&&n.loadBuffers))return;let s=t.getExtension(Sn);s&&((r=e.gltf)!==null&&r!==void 0&&r.loadImages&&Xa(t,s),ja(t,s))}function Xa(t,e){let n=e.propertyTextures,r=t.gltf.json;if(n&&r.meshes)for(let s of r.meshes)for(let o of s.primitives)ka(t,n,o,e)}function ja(t,e){let n=e.schema;if(!n)return;let r=n.classes,s=e.propertyTables;if(r&&s)for(let o in r){let i=Va(s,o);i&&Ya(t,n,i)}}function Va(t,e){for(let n of t)if(n.class===e)return n;return null}function ka(t,e,n,r){var s;if(!e)return;let o=(s=n.extensions)===null||s===void 0?void 0:s[Sn],i=o?.propertyTextures;if(i)for(let a of i){let c=e[a];Qa(t,c,n,r)}}function Qa(t,e,n,r){if(!e.properties)return;r.dataAttributeNames||(r.dataAttributeNames=[]);let s=e.class;for(let i in e.properties){var o;let a=`${s}_${i}`,c=(o=e.properties)===null||o===void 0?void 0:o[i];if(!c)continue;c.data||(c.data=[]);let f=c.data,l=be(t,c,n);l!==null&&(St(t,a,l,f,n),c.data=f,r.dataAttributeNames.push(a))}}function Ya(t,e,n){var r;let s=(r=e.classes)===null||r===void 0?void 0:r[n.class];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);let o=n.count;for(let a in s.properties){var i;let c=s.properties[a],f=(i=n.properties)===null||i===void 0?void 0:i[a];if(f){let l=Wa(t,e,c,o,f);f.data=l}}}function Wa(t,e,n,r,s){let o=[],i=s.values,a=t.getTypedArrayForBufferView(i),c=za(t,n,s,r),f=qa(t,s,r);switch(n.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":{o=Za(n,r,a,c);break}case"BOOLEAN":throw new Error(`Not implemented - classProperty.type=${n.type}`);case"STRING":{o=Ot(r,a,c,f);break}case"ENUM":{o=$a(e,n,r,a,c);break}default:throw new Error(`Unknown classProperty type ${n.type}`)}return o}function za(t,e,n,r){return e.array&&typeof e.count>"u"&&typeof n.arrayOffsets<"u"?Te(t,n.arrayOffsets,n.arrayOffsetType||"UINT32",r):null}function qa(t,e,n){return typeof e.stringOffsets<"u"?Te(t,e.stringOffsets,e.stringOffsetType||"UINT32",n):null}function Za(t,e,n,r){let s=t.array,o=t.count,i=ke(t.type,t.componentType),a=n.byteLength/i,c;return t.componentType?c=ye(n,t.type,t.componentType,a):c=n,s?r?Ft(c,e,r,n.length,i):o?Dt(c,e,o):[]:c}function $a(t,e,n,r,s){var o;let i=e.enumType;if(!i)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");let a=(o=t.enums)===null||o===void 0?void 0:o[i];if(!a)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${i}`);let c=a.valueType||"UINT16",f=ke(e.type,c),l=r.byteLength/f,A=ye(r,e.type,c,l);if(A||(A=r),e.array){if(s)return ec({valuesData:A,numberOfElements:n,arrayOffsets:s,valuesDataBytesLength:r.length,elementSize:f,enumEntry:a});let m=e.count;return m?tc(A,n,m,a):[]}return Fn(A,0,n,a)}function ec(t){let{valuesData:e,numberOfElements:n,arrayOffsets:r,valuesDataBytesLength:s,elementSize:o,enumEntry:i}=t,a=[];for(let c=0;c<n;c++){let f=r[c],l=r[c+1]-r[c];if(l+f>s)break;let A=f/o,m=l/o,u=Fn(e,A,m,i);a.push(u)}return a}function tc(t,e,n,r){let s=[];for(let o=0;o<e;o++){let i=n*o,a=Fn(t,i,n,r);s.push(a)}return s}function Fn(t,e,n,r){let s=[];for(let o=0;o<n;o++)if(t instanceof BigInt64Array||t instanceof BigUint64Array)s.push("");else{let i=t[e+o],a=nc(r,i);a?s.push(a.name):s.push("")}return s}function nc(t,e){for(let n of t.values)if(n.value===e)return n;return null}var On={};w(On,{decode:()=>sc,name:()=>rc});var po="EXT_feature_metadata",rc=po;async function sc(t,e){let n=new T(t);oc(n,e)}function oc(t,e){var n,r;if(!((n=e.gltf)!==null&&n!==void 0&&n.loadBuffers))return;let s=t.getExtension(po);s&&((r=e.gltf)!==null&&r!==void 0&&r.loadImages&&ic(t,s),ac(t,s))}function ic(t,e){let n=e.schema;if(!n)return;let r=n.classes,{featureTextures:s}=e;if(r&&s)for(let o in r){let i=r[o],a=fc(s,o);a&&Ac(t,a,i)}}function ac(t,e){let n=e.schema;if(!n)return;let r=n.classes,s=e.featureTables;if(r&&s)for(let o in r){let i=cc(s,o);i&&lc(t,n,i)}}function cc(t,e){for(let n in t){let r=t[n];if(r.class===e)return r}return null}function fc(t,e){for(let n in t){let r=t[n];if(r.class===e)return r}return null}function lc(t,e,n){var r;if(!n.class)return;let s=(r=e.classes)===null||r===void 0?void 0:r[n.class];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);let o=n.count;for(let a in s.properties){var i;let c=s.properties[a],f=(i=n.properties)===null||i===void 0?void 0:i[a];if(f){let l=mc(t,e,c,o,f);f.data=l}}}function Ac(t,e,n){let r=e.class;for(let o in n.properties){var s;let i=e==null||(s=e.properties)===null||s===void 0?void 0:s[o];if(i){let a=Bc(t,i,r);i.data=a}}}function mc(t,e,n,r,s){let o=[],i=s.bufferView,a=t.getTypedArrayForBufferView(i),c=uc(t,n,s,r),f=hc(t,n,s,r);return n.type==="STRING"||n.componentType==="STRING"?o=Ot(r,a,c,f):dc(n)&&(o=pc(n,r,a,c)),o}function uc(t,e,n,r){return e.type==="ARRAY"&&typeof e.componentCount>"u"&&typeof n.arrayOffsetBufferView<"u"?Te(t,n.arrayOffsetBufferView,n.offsetType||"UINT32",r):null}function hc(t,e,n,r){return typeof n.stringOffsetBufferView<"u"?Te(t,n.stringOffsetBufferView,n.offsetType||"UINT32",r):null}function dc(t){let e=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return e.includes(t.type)||typeof t.componentType<"u"&&e.includes(t.componentType)}function pc(t,e,n,r){let s=t.type==="ARRAY",o=t.componentCount,i="SCALAR",a=t.componentType||t.type,c=ke(i,a),f=n.byteLength/c,l=ye(n,i,a,f);return s?r?Ft(l,e,r,n.length,c):o?Dt(l,e,o):[]:l}function Bc(t,e,n){let r=t.gltf.json;if(!r.meshes)return[];let s=[];for(let o of r.meshes)for(let i of o.primitives)gc(t,n,e,s,i);return s}function gc(t,e,n,r,s){let o={channels:n.channels,...n.texture},i=be(t,o,s);i&&St(t,e,i,r,s)}var Bo="4.1.4";var Re=!0,go=1735152710,vn=12,Lt=8,xc=1313821514,Cc=5130562,Ec=0,Mc=0,_c=1;function Tc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}function xo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=new DataView(t),{magic:s=go}=n,o=r.getUint32(e,!1);return o===s||o===go}function Co(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=new DataView(e),o=Tc(s,n+0),i=s.getUint32(n+4,Re),a=s.getUint32(n+8,Re);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:o,version:i,json:{},binChunks:[]}),n+=vn,t.version){case 1:return yc(t,s,n);case 2:return bc(t,s,n,r={});default:throw new Error(`Invalid GLB version ${t.version}. Only supports version 1 and 2.`)}}function yc(t,e,n){U(t.header.byteLength>vn+Lt);let r=e.getUint32(n+0,Re),s=e.getUint32(n+4,Re);return n+=Lt,U(s===Ec),Ln(t,e,n,r),n+=r,n+=Gn(t,e,n,t.header.byteLength),n}function bc(t,e,n,r){return U(t.header.byteLength>vn+Lt),Rc(t,e,n,r),n+t.header.byteLength}function Rc(t,e,n,r){for(;n+8<=t.header.byteLength;){let s=e.getUint32(n+0,Re),o=e.getUint32(n+4,Re);switch(n+=Lt,o){case xc:Ln(t,e,n,s);break;case Cc:Gn(t,e,n,s);break;case Mc:r.strict||Ln(t,e,n,s);break;case _c:r.strict||Gn(t,e,n,s);break;default:break}n+=oe(s,4)}return n}function Ln(t,e,n,r){let s=new Uint8Array(e.buffer,n,r),i=new TextDecoder("utf8").decode(s);return t.json=JSON.parse(i),oe(r,4)}function Gn(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),oe(r,4)}function Pn(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;let r=e.baseUri||e.uri;if(!r)throw new Error(`'baseUri' must be provided to resolve relative url ${t}`);return r.substr(0,r.lastIndexOf("/")+1)+t}var Un={};w(Un,{decode:()=>Nc,name:()=>Uc});var Ic="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",Sc="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",Fc=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),Dc=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),Oc={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Lc={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function Eo(t,e,n,r,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE",i=await Gc();wc(i,i.exports[Lc[s]],t,e,n,r,i.exports[Oc[o||"NONE"]])}var wn;async function Gc(){return wn||(wn=vc()),wn}async function vc(){let t=Ic;WebAssembly.validate(Fc)&&(t=Sc,console.log("Warning: meshopt_decoder is using experimental SIMD support"));let e=await WebAssembly.instantiate(Pc(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function Pc(t){let e=new Uint8Array(t.length);for(let r=0;r<t.length;++r){let s=t.charCodeAt(r);e[r]=s>96?s-71:s>64?s-65:s>47?s+4:s>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?Dc[e[r]]:(e[r]-60)*64+e[++r];return e.buffer.slice(0,n)}function wc(t,e,n,r,s,o,i){let a=t.exports.sbrk,c=r+3&-4,f=a(c*s),l=a(o.length),A=new Uint8Array(t.exports.memory.buffer);A.set(o,l);let m=e(f,r,s,l,o.length);if(m===0&&i&&i(f,c,s),n.set(A.subarray(f,f+r*s)),a(f-a(0)),m!==0)throw new Error(`Malformed buffer data: ${m}`)}var Gt="EXT_meshopt_compression",Uc=Gt;async function Nc(t,e){var n,r;let s=new T(t);if(!(e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes)||!((r=e.gltf)!==null&&r!==void 0&&r.loadBuffers))return;let o=[];for(let i of t.json.bufferViews||[])o.push(Hc(s,i));await Promise.all(o),s.removeExtension(Gt)}async function Hc(t,e){let n=t.getObjectExtension(e,Gt);if(n){let{byteOffset:r=0,byteLength:s=0,byteStride:o,count:i,mode:a,filter:c="NONE",buffer:f}=n,l=t.gltf.buffers[f],A=new Uint8Array(l.arrayBuffer,l.byteOffset+r,s),m=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);await Eo(m,i,o,A,a,c),t.removeObjectExtension(e,Gt)}}var Nn={};w(Nn,{name:()=>Jc,preprocess:()=>Kc});var Ie="EXT_texture_webp",Jc=Ie;function Kc(t,e){let n=new T(t);if(!Tn("image/webp")){if(n.getRequiredExtensions().includes(Ie))throw new Error(`gltf: Required extension ${Ie} not supported by browser`);return}let{json:r}=n;for(let s of r.textures||[]){let o=n.getObjectExtension(s,Ie);o&&(s.source=o.source),n.removeObjectExtension(s,Ie)}n.removeExtension(Ie)}var Hn={};w(Hn,{name:()=>Xc,preprocess:()=>jc});var vt="KHR_texture_basisu",Xc=vt;function jc(t,e){let n=new T(t),{json:r}=n;for(let s of r.textures||[]){let o=n.getObjectExtension(s,vt);o&&(s.source=o.source,n.removeObjectExtension(s,vt))}n.removeExtension(vt)}var jn={};w(jn,{decode:()=>af,encode:()=>cf,name:()=>sf,preprocess:()=>of});var Mo="4.1.4";var _o={name:"Draco",id:"draco",module:"draco",version:Mo,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function yo(t,e,n){let r=bo(e.metadata),s=[],o=Vc(e.attributes);for(let i in t){let a=t[i],c=To(i,a,o[i]);s.push(c)}if(n){let i=To("indices",n);s.push(i)}return{fields:s,metadata:r}}function Vc(t){let e={};for(let n in t){let r=t[n];e[r.name||"undefined"]=r}return e}function To(t,e,n){let r=n?bo(n.metadata):void 0;return Ht(t,e,r)}function bo(t){Object.entries(t);let e={};for(let n in t)e[`${n}.string`]=JSON.stringify(t[n]);return e}var Ro={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},kc={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},Qc=4,Qe=class{constructor(e){this.draco=void 0,this.decoder=void 0,this.metadataQuerier=void 0,this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);let s=this.decoder.GetEncodedGeometryType(r),o=s===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let i;switch(s){case this.draco.TRIANGULAR_MESH:i=this.decoder.DecodeBufferToMesh(r,o);break;case this.draco.POINT_CLOUD:i=this.decoder.DecodeBufferToPointCloud(r,o);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!i.ok()||!o.ptr){let m=`DRACO decompression failed: ${i.error_msg()}`;throw new Error(m)}let a=this._getDracoLoaderData(o,s,n),c=this._getMeshData(o,a,n),f=Oe(c.attributes),l=yo(c.attributes,a,c.indices);return{loader:"draco",loaderData:a,header:{vertexCount:o.num_points(),boundingBox:f},...c,schema:l}}finally{this.draco.destroy(r),o&&this.draco.destroy(o)}}_getDracoLoaderData(e,n,r){let s=this._getTopLevelMetadata(e),o=this._getDracoAttributes(e,r);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:s,attributes:o}}_getDracoAttributes(e,n){let r={};for(let s=0;s<e.num_attributes();s++){let o=this.decoder.GetAttribute(e,s),i=this._getAttributeMetadata(e,s);r[o.unique_id()]={unique_id:o.unique_id(),attribute_type:o.attribute_type(),data_type:o.data_type(),num_components:o.num_components(),byte_offset:o.byte_offset(),byte_stride:o.byte_stride(),normalized:o.normalized(),attribute_index:s,metadata:i};let a=this._getQuantizationTransform(o,n);a&&(r[o.unique_id()].quantization_transform=a);let c=this._getOctahedronTransform(o,n);c&&(r[o.unique_id()].octahedron_transform=c)}return r}_getMeshData(e,n,r){let s=this._getMeshAttributes(n,e,r);if(!s.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(r.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:s,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:s,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:s}}_getMeshAttributes(e,n,r){let s={};for(let o of Object.values(e.attributes)){let i=this._deduceAttributeName(o,r);o.name=i;let{value:a,size:c}=this._getAttributeValues(n,o);s[i]={value:a,size:c,byteOffset:o.byte_offset,byteStride:o.byte_stride,normalized:o.normalized}}return s}_getTriangleListIndices(e){let r=e.num_faces()*3,s=r*Qc,o=this.draco._malloc(s);try{return this.decoder.GetTrianglesUInt32Array(e,s,o),new Uint32Array(this.draco.HEAPF32.buffer,o,r).slice()}finally{this.draco._free(o)}}_getTriangleStripIndices(e){let n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),zc(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){let r=kc[n.data_type],s=n.num_components,i=e.num_points()*s,a=i*r.BYTES_PER_ELEMENT,c=Yc(this.draco,r),f,l=this.draco._malloc(a);try{let A=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,A,c,a,l),f=new r(this.draco.HEAPF32.buffer,l,i).slice()}finally{this.draco._free(l)}return{value:f,size:s}}_deduceAttributeName(e,n){let r=e.unique_id;for(let[i,a]of Object.entries(n.extraAttributes||{}))if(a===r)return i;let s=e.attribute_type;for(let i in Ro)if(this.draco[i]===s)return Ro[i];let o=n.attributeNameEntry||"name";return e.metadata[o]?e.metadata[o].string:`CUSTOM_ATTRIBUTE_${r}`}_getTopLevelMetadata(e){let n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){let r=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};let n={},r=this.metadataQuerier.NumEntries(e);for(let s=0;s<r;s++){let o=this.metadataQuerier.GetEntryName(e,s);n[o]=this._getDracoMetadataField(e,o)}return n}_getDracoMetadataField(e,n){let r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,r);let s=Wc(r);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:s}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){let{quantizedAttributes:n=[],octahedronAttributes:r=[]}=e,s=[...n,...r];for(let o of s)this.decoder.SkipAttributeTransform(this.draco[o])}_getQuantizationTransform(e,n){let{quantizedAttributes:r=[]}=n,s=e.attribute_type();if(r.map(i=>this.decoder[i]).includes(s)){let i=new this.draco.AttributeQuantizationTransform;try{if(i.InitFromAttribute(e))return{quantization_bits:i.quantization_bits(),range:i.range(),min_values:new Float32Array([1,2,3]).map(a=>i.min_value(a))}}finally{this.draco.destroy(i)}}return null}_getOctahedronTransform(e,n){let{octahedronAttributes:r=[]}=n,s=e.attribute_type();if(r.map(i=>this.decoder[i]).includes(s)){let i=new this.draco.AttributeQuantizationTransform;try{if(i.InitFromAttribute(e))return{quantization_bits:i.quantization_bits()}}finally{this.draco.destroy(i)}}return null}};function Yc(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function Wc(t){let e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}function zc(t){let e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}var qc="1.5.6",Zc="1.4.1",Jn=`https://www.gstatic.com/draco/versioned/decoders/${qc}`,S={DECODER:"draco_wasm_wrapper.js",DECODER_WASM:"draco_decoder.wasm",FALLBACK_DECODER:"draco_decoder.js",ENCODER:"draco_encoder.js"},Kn={[S.DECODER]:`${Jn}/${S.DECODER}`,[S.DECODER_WASM]:`${Jn}/${S.DECODER_WASM}`,[S.FALLBACK_DECODER]:`${Jn}/${S.FALLBACK_DECODER}`,[S.ENCODER]:`https://raw.githubusercontent.com/google/draco/${Zc}/javascript/${S.ENCODER}`},Ye;async function Io(t){let e=t.modules||{};return e.draco3d?Ye=Ye||e.draco3d.createDecoderModule({}).then(n=>({draco:n})):Ye=Ye||$c(t),await Ye}async function $c(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await Q(Kn[S.FALLBACK_DECODER],"draco",t,S.FALLBACK_DECODER);break;case"wasm":default:[e,n]=await Promise.all([await Q(Kn[S.DECODER],"draco",t,S.DECODER),await Q(Kn[S.DECODER_WASM],"draco",t,S.DECODER_WASM)])}return e=e||globalThis.DracoDecoderModule,await ef(e,n)}function ef(t,e){let n={};return e&&(n.wasmBinary=e),new Promise(r=>{t({...n,onModuleLoaded:s=>r({draco:s})})})}var So={..._o,parse:tf};async function tf(t,e){let{draco:n}=await Io(e),r=new Qe(n);try{return r.parseSync(t,e?.draco)}finally{r.destroy()}}function Fo(t){let e={};for(let n in t){let r=t[n];if(n!=="indices"){let s=Xn(r);e[n]=s}}return e}function Xn(t){let{buffer:e,size:n,count:r}=nf(t);return{value:e,size:n,byteOffset:0,count:r,type:It(n),componentType:Me(e)}}function nf(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=rf(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}function rf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?Array.isArray(t)?new e(t):n&&!(t instanceof e)?new e(t):t:null}var ie="KHR_draco_mesh_compression",sf=ie;function of(t,e,n){let r=new T(t);for(let s of Do(r))r.getObjectExtension(s,ie)}async function af(t,e,n){var r;if(!(e!=null&&(r=e.gltf)!==null&&r!==void 0&&r.decompressMeshes))return;let s=new T(t),o=[];for(let i of Do(s))s.getObjectExtension(i,ie)&&o.push(ff(s,i,e,n));await Promise.all(o),s.removeExtension(ie)}function cf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=new T(t);for(let r of n.json.meshes||[])lf(r,e),n.addRequiredExtension(ie)}async function ff(t,e,n,r){let s=t.getObjectExtension(e,ie);if(!s)return;let o=t.getTypedArrayForBufferView(s.bufferView),i=Je(o.buffer,o.byteOffset),a={...n};delete a["3d-tiles"];let c=await Ne(i,So,a,r),f=Fo(c.attributes);for(let[l,A]of Object.entries(f))if(l in e.attributes){let m=e.attributes[l],u=t.getAccessor(m);u!=null&&u.min&&u!==null&&u!==void 0&&u.max&&(A.min=u.min,A.max=u.max)}e.attributes=f,c.indices&&(e.indices=Xn(c.indices)),t.removeObjectExtension(e,ie),Af(e)}function lf(t,e){var n;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,s=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(!s.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");let i=s.DracoWriter.encodeSync({attributes:t}),a=o==null||(n=o.parseSync)===null||n===void 0?void 0:n.call(o,{attributes:t}),c=s._addFauxAttributes(a.attributes),f=s.addBufferView(i);return{primitives:[{attributes:c,mode:r,extensions:{[ie]:{bufferView:f,attributes:c}}}]}}function Af(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Do(t){for(let e of t.json.meshes||[])for(let n of e.primitives)yield n}var kn={};w(kn,{decode:()=>df,name:()=>mf});var Vn="KHR_texture_transform",mf=Vn,Pt=new ae,uf=new Z,hf=new Z;async function df(t,e){var n;if(!new T(t).hasExtension(Vn)||!((n=e.gltf)!==null&&n!==void 0&&n.loadBuffers))return;let o=t.json.materials||[];for(let i=0;i<o.length;i++)pf(i,t)}function pf(t,e){var n,r,s;let o=[],i=(n=e.json.materials)===null||n===void 0?void 0:n[t],a=i==null||(r=i.pbrMetallicRoughness)===null||r===void 0?void 0:r.baseColorTexture;a&&We(e,t,a,o);let c=i?.emissiveTexture;c&&We(e,t,c,o);let f=i?.normalTexture;f&&We(e,t,f,o);let l=i?.occlusionTexture;l&&We(e,t,l,o);let A=i==null||(s=i.pbrMetallicRoughness)===null||s===void 0?void 0:s.metallicRoughnessTexture;A&&We(e,t,A,o)}function We(t,e,n,r){let s=Bf(n,r);if(!s)return;let o=t.json.meshes||[];for(let i of o)for(let a of i.primitives){let c=a.material;Number.isFinite(c)&&e===c&&gf(t,a,s)}}function Bf(t,e){var n;let r=(n=t.extensions)===null||n===void 0?void 0:n[Vn],{texCoord:s=0}=t,{texCoord:o=s}=r;if(!(e.findIndex(a=>{let[c,f]=a;return c===s&&f===o})!==-1)){let a=Ef(r);return s!==o&&(t.texCoord=o),e.push([s,o]),{originalTexCoord:s,texCoord:o,matrix:a}}return null}function gf(t,e,n){let{originalTexCoord:r,texCoord:s,matrix:o}=n,i=e.attributes[`TEXCOORD_${r}`];if(Number.isFinite(i)){var a;let f=(a=t.json.accessors)===null||a===void 0?void 0:a[i];if(f&&f.bufferView){var c;let l=(c=t.json.bufferViews)===null||c===void 0?void 0:c[f.bufferView];if(l){let{arrayBuffer:A,byteOffset:m}=t.buffers[l.buffer],u=(m||0)+(f.byteOffset||0)+(l.byteOffset||0),{ArrayType:h,length:d}=_e(f,l),p=Rt[f.componentType],g=bt[f.type],E=l.byteStride||p*g,B=new Float32Array(d);for(let x=0;x<f.count;x++){let C=new h(A,u+x*E,2);Pt.set(C[0],C[1],1),Pt.transformByMatrix3(o),B.set([Pt[0],Pt[1]],x*g)}r===s?xf(f,l,t.buffers,B):Cf(s,f,e,t,B)}}}}function xf(t,e,n,r){t.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),e.buffer=n.length-1,e.byteLength=r.buffer.byteLength,e.byteOffset=0,delete e.byteStride}function Cf(t,e,n,r,s){r.buffers.push({arrayBuffer:s.buffer,byteOffset:0,byteLength:s.buffer.byteLength});let o=r.json.bufferViews;if(!o)return;o.push({buffer:r.buffers.length-1,byteLength:s.buffer.byteLength,byteOffset:0});let i=r.json.accessors;i&&(i.push({bufferView:o?.length-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),n.attributes[`TEXCOORD_${t}`]=i.length-1)}function Ef(t){let{offset:e=[0,0],rotation:n=0,scale:r=[1,1]}=t,s=new Z().set(1,0,0,0,1,0,e[0],e[1],1),o=uf.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),i=hf.set(r[0],0,0,0,r[1],0,0,0,1);return s.multiplyRight(o).multiplyRight(i)}var Qn={};w(Qn,{decode:()=>_f,encode:()=>Tf,name:()=>Mf});var le="KHR_lights_punctual",Mf=le;async function _f(t){let e=new T(t),{json:n}=e,r=e.getExtension(le);r&&(e.json.lights=r.lights,e.removeExtension(le));for(let s of n.nodes||[]){let o=e.getObjectExtension(s,le);o&&(s.light=o.light),e.removeObjectExtension(s,le)}}async function Tf(t){let e=new T(t),{json:n}=e;if(n.lights){let r=e.addExtension(le);R(!r.lights),r.lights=n.lights,delete n.lights}if(e.json.lights){for(let r of e.json.lights){let s=r.node;e.addObjectExtension(s,le,r)}delete e.json.lights}}var Yn={};w(Yn,{decode:()=>bf,encode:()=>Rf,name:()=>yf});var ze="KHR_materials_unlit",yf=ze;async function bf(t){let e=new T(t),{json:n}=e;for(let r of n.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,ze);e.removeExtension(ze)}function Rf(t){let e=new T(t),{json:n}=e;if(e.materials)for(let r of n.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,ze,{}),e.addExtension(ze))}var Wn={};w(Wn,{decode:()=>Sf,encode:()=>Ff,name:()=>If});var qe="KHR_techniques_webgl",If=qe;async function Sf(t){let e=new T(t),{json:n}=e,r=e.getExtension(qe);if(r){let s=Df(r,e);for(let o of n.materials||[]){let i=e.getObjectExtension(o,qe);i&&(o.technique=Object.assign({},i,s[i.technique]),o.technique.values=Of(o.technique,e)),e.removeObjectExtension(o,qe)}e.removeExtension(qe)}}async function Ff(t,e){}function Df(t,e){let{programs:n=[],shaders:r=[],techniques:s=[]}=t,o=new TextDecoder;return r.forEach(i=>{if(Number.isFinite(i.bufferView))i.code=o.decode(e.getTypedArrayForBufferView(i.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(i=>{i.fragmentShader=r[i.fragmentShader],i.vertexShader=r[i.vertexShader]}),s.forEach(i=>{i.program=n[i.program]}),s}function Of(t,e){let n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(r=>{t.uniforms[r].value&&!(r in n)&&(n[r]=t.uniforms[r].value)}),Object.keys(n).forEach(r=>{typeof n[r]=="object"&&n[r].index!==void 0&&(n[r].texture=e.getTexture(n[r].index))}),n}var Oo=[Dn,In,Un,Nn,Hn,jn,Qn,Yn,Wn,kn,On];function Lo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=Oo.filter(o=>vo(o.name,e));for(let o of r){var s;(s=o.preprocess)===null||s===void 0||s.call(o,t,e,n)}}async function Go(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=Oo.filter(o=>vo(o.name,e));for(let o of r){var s;await((s=o.decode)===null||s===void 0?void 0:s.call(o,t,e,n))}}function vo(t,e){var n;let r=(e==null||(n=e.gltf)===null||n===void 0?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}var zn="KHR_binary_glTF";function Po(t){let e=new T(t),{json:n}=e;for(let r of n.images||[]){let s=e.getObjectExtension(r,zn);s&&Object.assign(r,s),e.removeObjectExtension(r,zn)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(zn)}var wo={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Gf={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},qn=class{constructor(){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}},this.json=void 0}normalize(e,n){this.json=e.json;let r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn(`glTF: Unknown version ${r.asset.version}`);return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),Po(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(let n in wo)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){let r=e[n];if(!(!r||Array.isArray(r))){e[n]=[];for(let s in r){let o=r[s];o.id=o.id||s;let i=e[n].length;e[n].push(o),this.idToIndexMap[n][s]=i}}}_convertObjectIdsToArrayIndices(e){for(let n in wo)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(let n of e.textures)this._convertTextureIds(n);for(let n of e.meshes)this._convertMeshIds(n);for(let n of e.nodes)this._convertNodeIds(n);for(let n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(let n of e.primitives){let{attributes:r,indices:s,material:o}=n;for(let i in r)r[i]=this._convertIdToIndex(r[i],"accessor");s&&(n.indices=this._convertIdToIndex(s,"accessor")),o&&(n.material=this._convertIdToIndex(o,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,"node"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(e,n){e[n]||(console.warn(`gltf v1: json doesn't contain attribute ${n}`),e[n]=[]);for(let r of e[n])for(let s in r){let o=r[s],i=this._convertIdToIndex(o,s);r[s]=i}}_convertIdToIndex(e,n){let r=Gf[n];if(r in this.idToIndexMap){let s=this.idToIndexMap[r][e];if(!Number.isFinite(s))throw new Error(`gltf v1: failed to resolve ${n} with id ${e}`);return s}return e}_updateObjects(e){for(let n of this.json.buffers)delete n.type}_updateMaterial(e){for(let o of e.materials){var n,r,s;o.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};let i=((n=o.values)===null||n===void 0?void 0:n.tex)||((r=o.values)===null||r===void 0?void 0:r.texture2d_0)||((s=o.values)===null||s===void 0?void 0:s.diffuseTex),a=e.textures.findIndex(c=>c.id===i);a!==-1&&(o.pbrMetallicRoughness.baseColorTexture={index:a})}}};function Uo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new qn().normalize(t,e)}async function No(t,e){var n,r,s;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return vf(t,e,o,i),Uo(t,{normalize:i==null||(n=i.gltf)===null||n===void 0?void 0:n.normalize}),Lo(t,i,a),i!=null&&(r=i.gltf)!==null&&r!==void 0&&r.loadBuffers&&t.json.buffers&&await Pf(t,i,a),i!=null&&(s=i.gltf)!==null&&s!==void 0&&s.loadImages&&await wf(t,i,a),await Go(t,i,a),t}function vf(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!xo(e,n,r)&&(e=new TextDecoder().decode(e)),typeof e=="string")t.json=dn(e);else if(e instanceof ArrayBuffer){let i={};n=Co(i,e,n,r.glb),R(i.type==="glTF",`Invalid GLB magic string ${i.type}`),t._glb=i,t.json=i.json}else R(!1,"GLTF: must be ArrayBuffer or string");let s=t.json.buffers||[];if(t.buffers=new Array(s.length).fill(null),t._glb&&t._glb.header.hasBinChunk){let{binChunks:i}=t._glb;t.buffers[0]={arrayBuffer:i[0].arrayBuffer,byteOffset:i[0].byteOffset,byteLength:i[0].byteLength}}let o=t.json.images||[];t.images=new Array(o.length).fill({})}async function Pf(t,e,n){let r=t.json.buffers||[];for(let i=0;i<r.length;++i){let a=r[i];if(a.uri){var s,o;let{fetch:c}=n;R(c);let f=Pn(a.uri,e),l=await(n==null||(s=n.fetch)===null||s===void 0?void 0:s.call(n,f)),A=await(l==null||(o=l.arrayBuffer)===null||o===void 0?void 0:o.call(l));t.buffers[i]={arrayBuffer:A,byteOffset:0,byteLength:A.byteLength},delete a.uri}else t.buffers[i]===null&&(t.buffers[i]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}async function wf(t,e,n){let r=Uf(t),s=t.json.images||[],o=[];for(let i of r)o.push(Nf(t,s[i],i,e,n));return await Promise.all(o)}function Uf(t){let e=new Set,n=t.json.textures||[];for(let r of n)r.source!==void 0&&e.add(r.source);return Array.from(e).sort()}async function Nf(t,e,n,r,s){let o;if(e.uri&&!e.hasOwnProperty("bufferView")){let a=Pn(e.uri,r),{fetch:c}=s;o=await(await c(a)).arrayBuffer(),e.bufferView={data:o}}if(Number.isFinite(e.bufferView)){let a=fo(t.json,t.buffers,e.bufferView);o=Je(a.buffer,a.byteOffset,a.byteLength)}R(o,"glTF image has no data");let i=await Ne(o,[Mn,hn],{...r,mimeType:e.mimeType,basis:r.basis||{format:Ct()}},s);i&&i[0]&&(i={compressed:!0,mipmaps:!1,width:i[0].width,height:i[0].height,data:i[0]}),t.images=t.images||[],t.images[n]=i}var Ze={name:"glTF",id:"gltf",module:"gltf",version:Bo,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:Hf,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}};async function Hf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;e={...Ze.options,...e},e.gltf={...Ze.options.gltf,...e.gltf};let{byteOffset:r=0}=e;return await No({},t,r,e,n)}var Jf={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Kf={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},N={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Xf={magFilter:N.TEXTURE_MAG_FILTER,minFilter:N.TEXTURE_MIN_FILTER,wrapS:N.TEXTURE_WRAP_S,wrapT:N.TEXTURE_WRAP_T},jf={[N.TEXTURE_MAG_FILTER]:N.LINEAR,[N.TEXTURE_MIN_FILTER]:N.NEAREST_MIPMAP_LINEAR,[N.TEXTURE_WRAP_S]:N.REPEAT,[N.TEXTURE_WRAP_T]:N.REPEAT};function Vf(){return{id:"default-sampler",parameters:jf}}function kf(t){return Kf[t]}function Qf(t){return Jf[t]}var Zn=class{constructor(){this.baseUri="",this.jsonUnprocessed=void 0,this.json=void 0,this.buffers=[],this.images=[]}postProcess(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{json:r,buffers:s=[],images:o=[]}=e,{baseUri:i=""}=e;return R(r),this.baseUri=i,this.buffers=s,this.images=o,this.jsonUnprocessed=r,this.json=this._resolveTree(e.json,n),this.json}_resolveTree(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r={...e};return this.json=r,e.bufferViews&&(r.bufferViews=e.bufferViews.map((s,o)=>this._resolveBufferView(s,o))),e.images&&(r.images=e.images.map((s,o)=>this._resolveImage(s,o))),e.samplers&&(r.samplers=e.samplers.map((s,o)=>this._resolveSampler(s,o))),e.textures&&(r.textures=e.textures.map((s,o)=>this._resolveTexture(s,o))),e.accessors&&(r.accessors=e.accessors.map((s,o)=>this._resolveAccessor(s,o))),e.materials&&(r.materials=e.materials.map((s,o)=>this._resolveMaterial(s,o))),e.meshes&&(r.meshes=e.meshes.map((s,o)=>this._resolveMesh(s,o))),e.nodes&&(r.nodes=e.nodes.map((s,o)=>this._resolveNode(s,o)),r.nodes=r.nodes.map((s,o)=>this._resolveNodeChildren(s))),e.skins&&(r.skins=e.skins.map((s,o)=>this._resolveSkin(s,o))),e.scenes&&(r.scenes=e.scenes.map((s,o)=>this._resolveScene(s,o))),typeof this.json.scene=="number"&&r.scenes&&(r.scene=r.scenes[this.json.scene]),r}getScene(e){return this._get(this.json.scenes,e)}getNode(e){return this._get(this.json.nodes,e)}getSkin(e){return this._get(this.json.skins,e)}getMesh(e){return this._get(this.json.meshes,e)}getMaterial(e){return this._get(this.json.materials,e)}getAccessor(e){return this._get(this.json.accessors,e)}getCamera(e){return this._get(this.json.cameras,e)}getTexture(e){return this._get(this.json.textures,e)}getSampler(e){return this._get(this.json.samplers,e)}getImage(e){return this._get(this.json.images,e)}getBufferView(e){return this._get(this.json.bufferViews,e)}getBuffer(e){return this._get(this.json.buffers,e)}_get(e,n){if(typeof n=="object")return n;let r=e&&e[n];return r||console.warn(`glTF file error: Could not find ${e}[${n}]`),r}_resolveScene(e,n){return{...e,id:e.id||`scene-${n}`,nodes:(e.nodes||[]).map(r=>this.getNode(r))}}_resolveNode(e,n){let r={...e,id:e?.id||`node-${n}`};return e.mesh!==void 0&&(r.mesh=this.getMesh(e.mesh)),e.camera!==void 0&&(r.camera=this.getCamera(e.camera)),e.skin!==void 0&&(r.skin=this.getSkin(e.skin)),e.meshes!==void 0&&e.meshes.length&&(r.mesh=e.meshes.reduce((s,o)=>{let i=this.getMesh(o);return s.id=i.id,s.primitives=s.primitives.concat(i.primitives),s},{primitives:[]})),r}_resolveNodeChildren(e){return e.children&&(e.children=e.children.map(n=>this.getNode(n))),e}_resolveSkin(e,n){let r=typeof e.inverseBindMatrices=="number"?this.getAccessor(e.inverseBindMatrices):void 0;return{...e,id:e.id||`skin-${n}`,inverseBindMatrices:r}}_resolveMesh(e,n){let r={...e,id:e.id||`mesh-${n}`,primitives:[]};return e.primitives&&(r.primitives=e.primitives.map(s=>{let o={...s,attributes:{},indices:void 0,material:void 0},i=s.attributes;for(let a in i)o.attributes[a]=this.getAccessor(i[a]);return s.indices!==void 0&&(o.indices=this.getAccessor(s.indices)),s.material!==void 0&&(o.material=this.getMaterial(s.material)),o})),r}_resolveMaterial(e,n){let r={...e,id:e.id||`material-${n}`};if(r.normalTexture&&(r.normalTexture={...r.normalTexture},r.normalTexture.texture=this.getTexture(r.normalTexture.index)),r.occlusionTexture&&(r.occlusionTexture={...r.occlusionTexture},r.occlusionTexture.texture=this.getTexture(r.occlusionTexture.index)),r.emissiveTexture&&(r.emissiveTexture={...r.emissiveTexture},r.emissiveTexture.texture=this.getTexture(r.emissiveTexture.index)),r.emissiveFactor||(r.emissiveFactor=r.emissiveTexture?[1,1,1]:[0,0,0]),r.pbrMetallicRoughness){r.pbrMetallicRoughness={...r.pbrMetallicRoughness};let s=r.pbrMetallicRoughness;s.baseColorTexture&&(s.baseColorTexture={...s.baseColorTexture},s.baseColorTexture.texture=this.getTexture(s.baseColorTexture.index)),s.metallicRoughnessTexture&&(s.metallicRoughnessTexture={...s.metallicRoughnessTexture},s.metallicRoughnessTexture.texture=this.getTexture(s.metallicRoughnessTexture.index))}return r}_resolveAccessor(e,n){let r=kf(e.componentType),s=Qf(e.type),o=r*s,i={...e,id:e.id||`accessor-${n}`,bytesPerComponent:r,components:s,bytesPerElement:o,value:void 0,bufferView:void 0,sparse:void 0};if(e.bufferView!==void 0&&(i.bufferView=this.getBufferView(e.bufferView)),i.bufferView){let a=i.bufferView.buffer,{ArrayType:c,byteLength:f}=_e(i,i.bufferView),l=(i.bufferView.byteOffset||0)+(i.byteOffset||0)+a.byteOffset,A=a.arrayBuffer.slice(l,l+f);i.bufferView.byteStride&&(A=this._getValueFromInterleavedBuffer(a,l,i.bufferView.byteStride,i.bytesPerElement,i.count)),i.value=new c(A)}return i}_getValueFromInterleavedBuffer(e,n,r,s,o){let i=new Uint8Array(o*s);for(let a=0;a<o;a++){let c=n+a*r;i.set(new Uint8Array(e.arrayBuffer.slice(c,c+s)),a*s)}return i.buffer}_resolveTexture(e,n){return{...e,id:e.id||`texture-${n}`,sampler:typeof e.sampler=="number"?this.getSampler(e.sampler):Vf(),source:typeof e.source=="number"?this.getImage(e.source):void 0}}_resolveSampler(e,n){let r={id:e.id||`sampler-${n}`,...e,parameters:{}};for(let s in r){let o=this._enumSamplerParameter(s);o!==void 0&&(r.parameters[o]=r[s])}return r}_enumSamplerParameter(e){return Xf[e]}_resolveImage(e,n){let r={...e,id:e.id||`image-${n}`,image:null,bufferView:e.bufferView!==void 0?this.getBufferView(e.bufferView):void 0},s=this.images[n];return s&&(r.image=s),r}_resolveBufferView(e,n){let r=e.buffer,s=this.buffers[r].arrayBuffer,o=this.buffers[r].byteOffset||0;return e.byteOffset&&(o+=e.byteOffset),{id:`bufferView-${n}`,...e,buffer:this.buffers[r],data:new Uint8Array(s,o,e.byteLength)}}_resolveCamera(e,n){let r={...e,id:e.id||`camera-${n}`};return r.perspective,r.orthographic,r}};function $n(t,e){return new Zn().postProcess(t,e)}async function Ho(t){let e=[];return t.scenes.forEach(n=>{n.traverse(r=>{Object.values(r.model.uniforms).forEach(s=>{s.loaded===!1&&e.push(s)})})}),await Yf(()=>e.some(n=>!n.loaded))}async function Yf(t){for(;t();)await new Promise(e=>requestAnimationFrame(e))}var Jo=`#version 300 es
#define SHADER_NAME scenegraph-layer-vertex-shader
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec3 positions;
#ifdef HAS_UV
in vec2 texCoords;
#endif
#ifdef MODULE_PBR
#ifdef HAS_NORMALS
in vec3 normals;
#endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
#ifdef HAS_UV
out vec2 vTEXCOORD_0;
#endif
#endif
void main(void) {
#if defined(HAS_UV) && !defined(MODULE_PBR)
vTEXCOORD_0 = texCoords;
geometry.uv = texCoords;
#endif
geometry.worldPosition = instancePositions;
geometry.pickingColor = instancePickingColors;
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vec3 normal = vec3(0.0, 0.0, 1.0);
#ifdef MODULE_PBR
#ifdef HAS_NORMALS
normal = instanceModelMatrix * (sceneModelMatrix * vec4(normals, 0.0)).xyz;
#endif
#endif
float originalSize = project_size_to_pixel(sizeScale);
float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);
vec3 pos = (instanceModelMatrix * (sceneModelMatrix * vec4(positions, 1.0)).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
if(composeModelMatrix) {
DECKGL_FILTER_SIZE(pos, geometry);
geometry.normal = project_normal(normal);
geometry.worldPosition += pos;
gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
}
else {
pos = project_size(pos);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
geometry.normal = project_normal(normal);
}
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
#ifdef MODULE_PBR
pbr_vPosition = geometry.position.xyz;
#ifdef HAS_NORMALS
pbr_vNormal = geometry.normal;
#endif
#ifdef HAS_UV
pbr_vUV = texCoords;
#else
pbr_vUV = vec2(0., 0.);
#endif
geometry.uv = pbr_vUV;
#endif
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var Ko=`#version 300 es
#define SHADER_NAME scenegraph-layer-fragment-shader
uniform float opacity;
in vec4 vColor;
out vec4 fragColor;
#ifndef MODULE_PBR
#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
in vec2 vTEXCOORD_0;
uniform sampler2D u_BaseColorSampler;
#endif
#endif
void main(void) {
#ifdef MODULE_PBR
fragColor = vColor * pbr_filterColor(vec4(0));
geometry.uv = pbr_vUV;
#else
#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
fragColor = vColor * texture(u_BaseColorSampler, vTEXCOORD_0);
geometry.uv = vTEXCOORD_0;
#else
fragColor = vColor;
#endif
#endif
fragColor.a *= opacity;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var Xo=[255,255,255,255],Wf={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?typeof t.scene=="object"?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Xo},_lighting:"flat",_imageBasedLightingEnvironment:void 0,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Ze]},wt=class extends z.Layer{getShaders(){let e=[z.project32,z.picking];return this.props._lighting==="pbr"&&e.push(we),super.getShaders({vs:Jo,fs:Ko,modules:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:"unorm8",size:this.props.colorFormat.length,accessor:"getColor",defaultValue:Xo,transition:!0},instanceModelMatrix:st})}updateState(e){super.updateState(e);let{props:n,oldProps:r}=e;n.scenegraph!==r.scenegraph?this._updateScenegraph():n._animations!==r._animations&&this._applyAnimationsProp(this.state.animator,n._animations)}finalizeState(e){super.finalizeState(e),this.state.scenegraph?.destroy()}get isLoaded(){return Boolean(this.state?.scenegraph&&super.isLoaded)}_updateScenegraph(){let e=this.props,{device:n}=this.context,r=null;if(e.scenegraph instanceof Ae.ScenegraphNode)r={scenes:[e.scenegraph]};else if(e.scenegraph&&typeof e.scenegraph=="object"){let a=e.scenegraph,c=a.json?$n(a):a,f=Rn(n,c,this._getModelOptions());r={gltf:c,...f},Ho(f).then(()=>{this.setNeedsRedraw()}).catch(l=>{this.raiseError(l,"loading glTF")})}let s={layer:this,device:this.context.device},o=e.getScene(r,s),i=e.getAnimator(r,s);if(o instanceof Ae.GroupNode){this.state.scenegraph?.destroy(),this._applyAnimationsProp(i,e._animations);let a=[];o.traverse(c=>{c instanceof Ae.ModelNode&&a.push(c.model)}),this.setState({scenegraph:o,animator:i,models:a}),this.getAttributeManager().invalidateAll()}else o!==null&&z.log.warn("invalid scenegraph:",o)()}_applyAnimationsProp(e,n){if(!e||!n)return;let r=e.getAnimations();Object.keys(n).sort().forEach(s=>{let o=n[s];if(s==="*")r.forEach(i=>{Object.assign(i,o)});else if(Number.isFinite(Number(s))){let i=Number(s);i>=0&&i<r.length?Object.assign(r[i],o):z.log.warn(`animation ${s} not found`)()}else{let i=r.find(({name:a})=>a===s);i?Object.assign(i,o):z.log.warn(`animation ${s} not found`)()}})}_getModelOptions(){let{_imageBasedLightingEnvironment:e}=this.props,n;return e&&(typeof e=="function"?n=e({gl:this.context.gl,layer:this}):n=e),{imageBasedLightingEnvironment:n,modelOptions:{id:this.props.id,isInstanced:!0,bufferLayout:this.getAttributeManager().getBufferLayouts(),...this.getShaders()},useTangents:!1}}draw({context:e}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(e.timeline.getTime()),this.setNeedsRedraw());let{viewport:n,renderPass:r}=this.context,{sizeScale:s,sizeMinPixels:o,sizeMaxPixels:i,opacity:a,coordinateSystem:c}=this.props,f=this.getNumInstances();this.state.scenegraph.traverse((l,{worldMatrix:A})=>{if(l instanceof Ae.ModelNode){let{model:m}=l;m.setInstanceCount(f),m.setUniforms({sizeScale:s,opacity:a,sizeMinPixels:o,sizeMaxPixels:i,composeModelMatrix:ot(n,c),sceneModelMatrix:A,u_Camera:m.uniforms.project_uCameraPosition}),m.draw(r)}})}},$e=wt;(()=>{wt.defaultProps=Wf})(),(()=>{wt.layerName="ScenegraphLayer"})();return Wo(et);})();
      return __exports__;
      });
